<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Volatility Models | MA 5124 Financial Time Series Analysis &amp; Forecasting</title>
  <meta name="description" content="Chapter 4 Volatility Models | MA 5124 Financial Time Series Analysis &amp; Forecasting" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Volatility Models | MA 5124 Financial Time Series Analysis &amp; Forecasting" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Volatility Models | MA 5124 Financial Time Series Analysis &amp; Forecasting" />
  
  
  

<meta name="author" content="Dr. Priyanga D. Talagala" />


<meta name="date" content="2021-04-04" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="exponential-smoothing.html"/>
<link rel="next" href="multivariate-time-series-modelling.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">MA 5124 Financial Time Series Analysis & Forecasting</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Course Syllabus</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#pre-requiites"><i class="fa fa-check"></i>Pre-requiites</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#learning-objectives"><i class="fa fa-check"></i>Learning Objectives</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#learning-outcomes"><i class="fa fa-check"></i>Learning Outcomes</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#outline-syllabus"><i class="fa fa-check"></i>Outline Syllabus</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#method-of-assessment"><i class="fa fa-check"></i>Method of Assessment</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#lecturer"><i class="fa fa-check"></i>Lecturer</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#schedule"><i class="fa fa-check"></i>Schedule</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#copyright-notice"><i class="fa fa-check"></i>Copyright Notice</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Intordution to Time Series Forecasting</a></li>
<li class="chapter" data-level="2" data-path="arima-models.html"><a href="arima-models.html"><i class="fa fa-check"></i><b>2</b> ARIMA models</a><ul>
<li class="chapter" data-level="2.1" data-path="arima-models.html"><a href="arima-models.html#stationarity-and-differencing"><i class="fa fa-check"></i><b>2.1</b> Stationarity and differencing</a><ul>
<li class="chapter" data-level="2.1.1" data-path="arima-models.html"><a href="arima-models.html#stationarity"><i class="fa fa-check"></i><b>2.1.1</b> Stationarity</a></li>
<li class="chapter" data-level="2.1.2" data-path="arima-models.html"><a href="arima-models.html#differencing"><i class="fa fa-check"></i><b>2.1.2</b> Differencing</a></li>
<li class="chapter" data-level="2.1.3" data-path="arima-models.html"><a href="arima-models.html#backshift-notation"><i class="fa fa-check"></i><b>2.1.3</b> Backshift notation</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="arima-models.html"><a href="arima-models.html#non-seasonal-arima-models"><i class="fa fa-check"></i><b>2.2</b> Non-seasonal ARIMA models</a><ul>
<li class="chapter" data-level="2.2.1" data-path="arima-models.html"><a href="arima-models.html#autoregressive-models"><i class="fa fa-check"></i><b>2.2.1</b> Autoregressive models</a></li>
<li class="chapter" data-level="2.2.2" data-path="arima-models.html"><a href="arima-models.html#moving-average-ma-models"><i class="fa fa-check"></i><b>2.2.2</b> Moving Average (MA) models</a></li>
<li class="chapter" data-level="2.2.3" data-path="arima-models.html"><a href="arima-models.html#invertibility"><i class="fa fa-check"></i><b>2.2.3</b> Invertibility</a></li>
<li class="chapter" data-level="2.2.4" data-path="arima-models.html"><a href="arima-models.html#arima-models-1"><i class="fa fa-check"></i><b>2.2.4</b> ARIMA models</a></li>
<li class="chapter" data-level="2.2.5" data-path="arima-models.html"><a href="arima-models.html#backshift-notation-for-arima"><i class="fa fa-check"></i><b>2.2.5</b> Backshift notation for ARIMA</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="arima-models.html"><a href="arima-models.html#estimation-and-order-selection"><i class="fa fa-check"></i><b>2.3</b> Estimation and order selection</a><ul>
<li class="chapter" data-level="2.3.1" data-path="arima-models.html"><a href="arima-models.html#maximum-likelihood-estimation"><i class="fa fa-check"></i><b>2.3.1</b> Maximum likelihood estimation</a></li>
<li class="chapter" data-level="2.3.2" data-path="arima-models.html"><a href="arima-models.html#partial-autocorrelations"><i class="fa fa-check"></i><b>2.3.2</b> Partial autocorrelations</a></li>
<li class="chapter" data-level="2.3.3" data-path="arima-models.html"><a href="arima-models.html#acf-and-pacf-interpretation"><i class="fa fa-check"></i><b>2.3.3</b> ACF and PACF interpretation</a></li>
<li class="chapter" data-level="2.3.4" data-path="arima-models.html"><a href="arima-models.html#information-criteria"><i class="fa fa-check"></i><b>2.3.4</b> Information criteria</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="arima-models.html"><a href="arima-models.html#seasonal-arima-models"><i class="fa fa-check"></i><b>2.4</b> Seasonal ARIMA models</a><ul>
<li class="chapter" data-level="2.4.1" data-path="arima-models.html"><a href="arima-models.html#common-arima-models"><i class="fa fa-check"></i><b>2.4.1</b> Common ARIMA models</a></li>
<li class="chapter" data-level="2.4.2" data-path="arima-models.html"><a href="arima-models.html#seasonal-arima-models-1"><i class="fa fa-check"></i><b>2.4.2</b> Seasonal ARIMA models</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="arima-models.html"><a href="arima-models.html#theoretical-properties-of-the-models"><i class="fa fa-check"></i><b>2.5</b> Theoretical properties of the models</a><ul>
<li class="chapter" data-level="2.5.1" data-path="arima-models.html"><a href="arima-models.html#autoregressive-ar-models"><i class="fa fa-check"></i><b>2.5.1</b> Autoregressive (AR) models</a></li>
<li class="chapter" data-level="2.5.2" data-path="arima-models.html"><a href="arima-models.html#moving-average-ma-models-1"><i class="fa fa-check"></i><b>2.5.2</b> Moving average (MA) models</a></li>
<li class="chapter" data-level="2.5.3" data-path="arima-models.html"><a href="arima-models.html#dual-relation-between-ar-and-ma-process"><i class="fa fa-check"></i><b>2.5.3</b> Dual relation between AR and MA process</a></li>
<li class="chapter" data-level="2.5.4" data-path="arima-models.html"><a href="arima-models.html#autoregressive-and-moving-average-arma-models"><i class="fa fa-check"></i><b>2.5.4</b> Autoregressive and Moving-average (ARMA) models</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="arima-models.html"><a href="arima-models.html#unit-root-tests"><i class="fa fa-check"></i><b>2.6</b> Unit root tests</a><ul>
<li class="chapter" data-level="2.6.1" data-path="arima-models.html"><a href="arima-models.html#dickey-fuller-test"><i class="fa fa-check"></i><b>2.6.1</b> Dickey-Fuller test</a></li>
<li class="chapter" data-level="2.6.2" data-path="arima-models.html"><a href="arima-models.html#augmented-dickey-fuller-test"><i class="fa fa-check"></i><b>2.6.2</b> Augmented Dickey-Fuller test</a></li>
<li class="chapter" data-level="2.6.3" data-path="arima-models.html"><a href="arima-models.html#stationarity-tests"><i class="fa fa-check"></i><b>2.6.3</b> Stationarity Tests</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="arima-models.html"><a href="arima-models.html#arima-modelling-in-r"><i class="fa fa-check"></i><b>2.7</b> ARIMA modelling in R</a><ul>
<li class="chapter" data-level="2.7.1" data-path="arima-models.html"><a href="arima-models.html#how-does-arima-work"><i class="fa fa-check"></i><b>2.7.1</b> How does ARIMA() work?</a></li>
<li class="chapter" data-level="2.7.2" data-path="arima-models.html"><a href="arima-models.html#choosing-your-own-model"><i class="fa fa-check"></i><b>2.7.2</b> Choosing your own model</a></li>
<li class="chapter" data-level="2.7.3" data-path="arima-models.html"><a href="arima-models.html#modelling-procedure-with-arima"><i class="fa fa-check"></i><b>2.7.3</b> Modelling procedure with <code>ARIMA()</code></a></li>
<li class="chapter" data-level="2.7.4" data-path="arima-models.html"><a href="arima-models.html#automatic-modelling-procedure-with-arima"><i class="fa fa-check"></i><b>2.7.4</b> Automatic modelling procedure with <code>ARIMA()</code></a></li>
<li class="chapter" data-level="2.7.5" data-path="arima-models.html"><a href="arima-models.html#example-in-r"><i class="fa fa-check"></i><b>2.7.5</b> Example in R</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="arima-models.html"><a href="arima-models.html#forecasting"><i class="fa fa-check"></i><b>2.8</b> Forecasting</a><ul>
<li class="chapter" data-level="2.8.1" data-path="arima-models.html"><a href="arima-models.html#point-forecasts"><i class="fa fa-check"></i><b>2.8.1</b> Point forecasts</a></li>
<li class="chapter" data-level="2.8.2" data-path="arima-models.html"><a href="arima-models.html#prediction-intervals"><i class="fa fa-check"></i><b>2.8.2</b> Prediction intervals</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="arima-models.html"><a href="arima-models.html#references"><i class="fa fa-check"></i><b>2.9</b> References:</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html"><i class="fa fa-check"></i><b>3</b> Exponential Smoothing</a><ul>
<li class="chapter" data-level="3.1" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#introduction"><i class="fa fa-check"></i><b>3.1</b> Introduction</a><ul>
<li class="chapter" data-level="3.1.1" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#historical-perspective"><i class="fa fa-check"></i><b>3.1.1</b> Historical perspective</a></li>
<li class="chapter" data-level="3.1.2" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#big-idea-control-the-rate-of-change"><i class="fa fa-check"></i><b>3.1.2</b> Big idea: control the rate of change</a></li>
<li class="chapter" data-level="3.1.3" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#a-model-for-levels-trends-and-seasonalities"><i class="fa fa-check"></i><b>3.1.3</b> A model for levels, trends, and seasonalities</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#simple-exponential-smoothing"><i class="fa fa-check"></i><b>3.2</b> Simple exponential smoothing</a><ul>
<li class="chapter" data-level="3.2.1" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#optimising-smoothing-parameters"><i class="fa fa-check"></i><b>3.2.1</b> Optimising smoothing parameters</a></li>
<li class="chapter" data-level="3.2.2" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#models-and-methods"><i class="fa fa-check"></i><b>3.2.2</b> Models and methods</a></li>
<li class="chapter" data-level="3.2.3" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#etsann-a-model-for-ses"><i class="fa fa-check"></i><b>3.2.3</b> ETS(A,N,N): A model for SES</a></li>
<li class="chapter" data-level="3.2.4" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#etsann"><i class="fa fa-check"></i><b>3.2.4</b> ETS(A,N,N)</a></li>
<li class="chapter" data-level="3.2.5" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#etsmnn"><i class="fa fa-check"></i><b>3.2.5</b> ETS(M,N,N)</a></li>
<li class="chapter" data-level="3.2.6" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#etsann-specifying-the-model"><i class="fa fa-check"></i><b>3.2.6</b> ETS(A,N,N): Specifying the model</a></li>
<li class="chapter" data-level="3.2.7" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#example-algerian-exports"><i class="fa fa-check"></i><b>3.2.7</b> Example: Algerian Exports</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#models-with-trend"><i class="fa fa-check"></i><b>3.3</b> Models with trend</a><ul>
<li class="chapter" data-level="3.3.1" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#holts-linear-trend"><i class="fa fa-check"></i><b>3.3.1</b> Holt’s linear trend</a></li>
<li class="chapter" data-level="3.3.2" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#etsaan"><i class="fa fa-check"></i><b>3.3.2</b> ETS(A,A,N)</a></li>
<li class="chapter" data-level="3.3.3" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#exponential-smoothing-trendslope"><i class="fa fa-check"></i><b>3.3.3</b> Exponential smoothing: trend/slope</a></li>
<li class="chapter" data-level="3.3.4" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#etsman"><i class="fa fa-check"></i><b>3.3.4</b> ETS(M,A,N)</a></li>
<li class="chapter" data-level="3.3.5" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#etsaan-specifying-the-model"><i class="fa fa-check"></i><b>3.3.5</b> ETS(A,A,N): Specifying the model</a></li>
<li class="chapter" data-level="3.3.6" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#example-australian-population"><i class="fa fa-check"></i><b>3.3.6</b> Example: Australian population</a></li>
<li class="chapter" data-level="3.3.7" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#damped-trend-method"><i class="fa fa-check"></i><b>3.3.7</b> Damped trend method</a></li>
<li class="chapter" data-level="3.3.8" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#example-australian-population-1"><i class="fa fa-check"></i><b>3.3.8</b> Example: Australian population</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#models-with-seasonality"><i class="fa fa-check"></i><b>3.4</b> Models with seasonality</a><ul>
<li class="chapter" data-level="3.4.1" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#holt-winters-additive-method"><i class="fa fa-check"></i><b>3.4.1</b> Holt-Winters additive method</a></li>
<li class="chapter" data-level="3.4.2" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#etsaaa"><i class="fa fa-check"></i><b>3.4.2</b> ETS(A,A,A)</a></li>
<li class="chapter" data-level="3.4.3" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#holt-winters-multiplicative-method"><i class="fa fa-check"></i><b>3.4.3</b> Holt-Winters multiplicative method</a></li>
<li class="chapter" data-level="3.4.4" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#etsmam"><i class="fa fa-check"></i><b>3.4.4</b> ETS(M,A,M)</a></li>
<li class="chapter" data-level="3.4.5" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#example-australian-holiday-tourism"><i class="fa fa-check"></i><b>3.4.5</b> Example: Australian holiday tourism</a></li>
<li class="chapter" data-level="3.4.6" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#holt-winters-damped-method"><i class="fa fa-check"></i><b>3.4.6</b> Holt-Winters damped method</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#innovations-state-space-models"><i class="fa fa-check"></i><b>3.5</b> Innovations state space models</a><ul>
<li class="chapter" data-level="3.5.1" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#exponential-smoothing-methods"><i class="fa fa-check"></i><b>3.5.1</b> Exponential smoothing methods</a></li>
<li class="chapter" data-level="3.5.2" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#ets-models"><i class="fa fa-check"></i><b>3.5.2</b> ETS models</a></li>
<li class="chapter" data-level="3.5.3" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#additive-error-models"><i class="fa fa-check"></i><b>3.5.3</b> Additive error models</a></li>
<li class="chapter" data-level="3.5.4" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#multiplicative-error-models"><i class="fa fa-check"></i><b>3.5.4</b> Multiplicative error models</a></li>
<li class="chapter" data-level="3.5.5" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#estimating-ets-models"><i class="fa fa-check"></i><b>3.5.5</b> Estimating ETS models</a></li>
<li class="chapter" data-level="3.5.6" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#innovations-state-space-models-1"><i class="fa fa-check"></i><b>3.5.6</b> Innovations state space models</a></li>
<li class="chapter" data-level="3.5.7" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#innovations-state-space-models-2"><i class="fa fa-check"></i><b>3.5.7</b> Innovations state space models</a></li>
<li class="chapter" data-level="3.5.8" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#parameter-restrictions"><i class="fa fa-check"></i><b>3.5.8</b> Parameter restrictions</a></li>
<li class="chapter" data-level="3.5.9" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#model-selection"><i class="fa fa-check"></i><b>3.5.9</b> Model selection</a></li>
<li class="chapter" data-level="3.5.10" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#aic-and-cross-validation"><i class="fa fa-check"></i><b>3.5.10</b> AIC and cross-validation</a></li>
<li class="chapter" data-level="3.5.11" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#automatic-forecasting"><i class="fa fa-check"></i><b>3.5.11</b> Automatic forecasting</a></li>
<li class="chapter" data-level="3.5.12" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#example-national-populations"><i class="fa fa-check"></i><b>3.5.12</b> Example: National populations</a></li>
<li class="chapter" data-level="3.5.13" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#example-australian-holiday-tourism-1"><i class="fa fa-check"></i><b>3.5.13</b> Example: Australian holiday tourism</a></li>
<li class="chapter" data-level="3.5.14" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#some-unstable-models"><i class="fa fa-check"></i><b>3.5.14</b> Some unstable models</a></li>
<li class="chapter" data-level="3.5.15" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#exponential-smoothing-models"><i class="fa fa-check"></i><b>3.5.15</b> Exponential smoothing models</a></li>
<li class="chapter" data-level="3.5.16" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#residuals"><i class="fa fa-check"></i><b>3.5.16</b> Residuals</a></li>
<li class="chapter" data-level="3.5.17" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#example-australian-holiday-tourism-2"><i class="fa fa-check"></i><b>3.5.17</b> Example: Australian holiday tourism</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#forecasting-with-exponential-smoothing"><i class="fa fa-check"></i><b>3.6</b> Forecasting with exponential smoothing</a><ul>
<li class="chapter" data-level="3.6.1" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#forecasting-with-ets-models"><i class="fa fa-check"></i><b>3.6.1</b> Forecasting with ETS models</a></li>
<li class="chapter" data-level="3.6.2" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#example-etsaan"><i class="fa fa-check"></i><b>3.6.2</b> Example: ETS(A,A,N)</a></li>
<li class="chapter" data-level="3.6.3" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#example-etsman"><i class="fa fa-check"></i><b>3.6.3</b> Example: ETS(M,A,N)</a></li>
<li class="chapter" data-level="3.6.4" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#forecasting-with-ets-models-1"><i class="fa fa-check"></i><b>3.6.4</b> Forecasting with ETS models</a></li>
<li class="chapter" data-level="3.6.5" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#prediction-intervals-1"><i class="fa fa-check"></i><b>3.6.5</b> Prediction intervals</a></li>
<li class="chapter" data-level="3.6.6" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#example-corticosteroid-drug-sales"><i class="fa fa-check"></i><b>3.6.6</b> Example: Corticosteroid drug sales</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#arima-vs-ets"><i class="fa fa-check"></i><b>3.7</b> ARIMA vs ETS</a><ul>
<li class="chapter" data-level="3.7.1" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#equivalences"><i class="fa fa-check"></i><b>3.7.1</b> Equivalences</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#references-1"><i class="fa fa-check"></i><b>3.8</b> References:</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="volatility-models.html"><a href="volatility-models.html"><i class="fa fa-check"></i><b>4</b> Volatility Models</a><ul>
<li class="chapter" data-level="4.1" data-path="volatility-models.html"><a href="volatility-models.html#introduction-1"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="volatility-models.html"><a href="volatility-models.html#structure-of-a-model-for-asset-returns"><i class="fa fa-check"></i><b>4.2</b> Structure of a Model for Asset Returns</a></li>
<li class="chapter" data-level="4.3" data-path="volatility-models.html"><a href="volatility-models.html#model-building"><i class="fa fa-check"></i><b>4.3</b> Model Building</a></li>
<li class="chapter" data-level="4.4" data-path="volatility-models.html"><a href="volatility-models.html#testing-for-arch-effect"><i class="fa fa-check"></i><b>4.4</b> Testing for ARCH Effect</a></li>
<li class="chapter" data-level="4.5" data-path="volatility-models.html"><a href="volatility-models.html#autoregressive-conditional-heteroskedastic-arch-models"><i class="fa fa-check"></i><b>4.5</b> Autoregressive Conditional Heteroskedastic (ARCH) Models</a><ul>
<li class="chapter" data-level="4.5.1" data-path="volatility-models.html"><a href="volatility-models.html#example-building-an-arch-model"><i class="fa fa-check"></i><b>4.5.1</b> Example: Building an ARCH Model</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="volatility-models.html"><a href="volatility-models.html#generalized-arch-garch-models"><i class="fa fa-check"></i><b>4.6</b> Generalized ARCH (GARCH) Models</a><ul>
<li class="chapter" data-level="4.6.1" data-path="volatility-models.html"><a href="volatility-models.html#prediction-of-volatilities"><i class="fa fa-check"></i><b>4.6.1</b> Prediction of volatilities</a></li>
<li class="chapter" data-level="4.6.2" data-path="volatility-models.html"><a href="volatility-models.html#example-building-a-garch-model"><i class="fa fa-check"></i><b>4.6.2</b> Example: Building a GARCH Model</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="volatility-models.html"><a href="volatility-models.html#the-arma-garch-models"><i class="fa fa-check"></i><b>4.7</b> The ARMA-GARCH Models</a><ul>
<li class="chapter" data-level="4.7.1" data-path="volatility-models.html"><a href="volatility-models.html#example-building-an-arma-garch-model"><i class="fa fa-check"></i><b>4.7.1</b> Example: Building an ARMA-GARCH Model</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="volatility-models.html"><a href="volatility-models.html#other-arch-type-models"><i class="fa fa-check"></i><b>4.8</b> Other ARCH-Type Models</a><ul>
<li class="chapter" data-level="4.8.1" data-path="volatility-models.html"><a href="volatility-models.html#the-integrated-garch-igarch-model"><i class="fa fa-check"></i><b>4.8.1</b> The Integrated GARCH (IGARCH) model</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="volatility-models.html"><a href="volatility-models.html#asymmetry-in-volatility"><i class="fa fa-check"></i><b>4.9</b> Asymmetry in Volatility</a></li>
<li class="chapter" data-level="4.10" data-path="volatility-models.html"><a href="volatility-models.html#the-exponential-garch-model"><i class="fa fa-check"></i><b>4.10</b> The exponential GARCH model</a></li>
<li class="chapter" data-level="4.11" data-path="volatility-models.html"><a href="volatility-models.html#stochastic-volatility-models"><i class="fa fa-check"></i><b>4.11</b> Stochastic Volatility Models</a></li>
<li class="chapter" data-level="4.12" data-path="volatility-models.html"><a href="volatility-models.html#references-2"><i class="fa fa-check"></i><b>4.12</b> References:</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="multivariate-time-series-modelling.html"><a href="multivariate-time-series-modelling.html"><i class="fa fa-check"></i><b>5</b> Multivariate Time Series Modelling</a><ul>
<li class="chapter" data-level="5.1" data-path="multivariate-time-series-modelling.html"><a href="multivariate-time-series-modelling.html#introduction-2"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="multivariate-time-series-modelling.html"><a href="multivariate-time-series-modelling.html#the-cross-correlation-function"><i class="fa fa-check"></i><b>5.2</b> The Cross-Correlation Function</a></li>
<li class="chapter" data-level="5.3" data-path="multivariate-time-series-modelling.html"><a href="multivariate-time-series-modelling.html#vector-autoregressive-models"><i class="fa fa-check"></i><b>5.3</b> Vector Autoregressive Models</a><ul>
<li class="chapter" data-level="5.3.1" data-path="multivariate-time-series-modelling.html"><a href="multivariate-time-series-modelling.html#var1-models"><i class="fa fa-check"></i><b>5.3.1</b> VAR(1) models</a></li>
<li class="chapter" data-level="5.3.2" data-path="multivariate-time-series-modelling.html"><a href="multivariate-time-series-modelling.html#varp-models"><i class="fa fa-check"></i><b>5.3.2</b> VAR(p) models</a></li>
<li class="chapter" data-level="5.3.3" data-path="multivariate-time-series-modelling.html"><a href="multivariate-time-series-modelling.html#vector-arma-models"><i class="fa fa-check"></i><b>5.3.3</b> Vector ARMA models</a></li>
<li class="chapter" data-level="5.3.4" data-path="multivariate-time-series-modelling.html"><a href="multivariate-time-series-modelling.html#vector-arima-models"><i class="fa fa-check"></i><b>5.3.4</b> Vector ARIMA models</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="multivariate-time-series-modelling.html"><a href="multivariate-time-series-modelling.html#fitting-var-and-varma-models"><i class="fa fa-check"></i><b>5.4</b> Fitting VAR and VARMA models</a><ul>
<li class="chapter" data-level="5.4.1" data-path="multivariate-time-series-modelling.html"><a href="multivariate-time-series-modelling.html#forecasting-1"><i class="fa fa-check"></i><b>5.4.1</b> Forecasting</a></li>
<li class="chapter" data-level="5.4.2" data-path="multivariate-time-series-modelling.html"><a href="multivariate-time-series-modelling.html#order-selection"><i class="fa fa-check"></i><b>5.4.2</b> Order Selection</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="multivariate-time-series-modelling.html"><a href="multivariate-time-series-modelling.html#granger-causality-tests"><i class="fa fa-check"></i><b>5.5</b> Granger Causality Tests</a><ul>
<li class="chapter" data-level="5.5.1" data-path="multivariate-time-series-modelling.html"><a href="multivariate-time-series-modelling.html#test-for-granger-causality"><i class="fa fa-check"></i><b>5.5.1</b> Test for Granger causality</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="multivariate-time-series-modelling.html"><a href="multivariate-time-series-modelling.html#cointegration"><i class="fa fa-check"></i><b>5.6</b> Cointegration</a><ul>
<li class="chapter" data-level="5.6.1" data-path="multivariate-time-series-modelling.html"><a href="multivariate-time-series-modelling.html#testing-for-cointegration"><i class="fa fa-check"></i><b>5.6.1</b> Testing for Cointegration</a></li>
<li class="chapter" data-level="5.6.2" data-path="multivariate-time-series-modelling.html"><a href="multivariate-time-series-modelling.html#vector-error-correction-models"><i class="fa fa-check"></i><b>5.6.2</b> Vector Error Correction Models</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="multivariate-time-series-modelling.html"><a href="multivariate-time-series-modelling.html#references-3"><i class="fa fa-check"></i><b>5.7</b> References:</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tutorial.html"><a href="tutorial.html"><i class="fa fa-check"></i>Tutorial</a><ul>
<li class="chapter" data-level="" data-path="tutorial.html"><a href="tutorial.html#ma-5124-financial-time-series-analysis-forecasting"><i class="fa fa-check"></i>MA 5124 Financial Time Series Analysis &amp; Forecasting</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references-4.html"><a href="references-4.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">MA 5124 Financial Time Series Analysis &amp; Forecasting</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="volatility-models" class="section level1">
<h1><span class="header-section-number">Chapter 4</span> Volatility Models</h1>
<!-- Note GARCH model parameter order- I followed TSay book , chatfield2019analysis GARCh parameter order is different. I followed tsay because fGarch package also follows the same order -->
<!-- very important :" Chatfield book data and R code avialbale here: http://www.ams.sunysb.edu/~xing/tsRbook/functions.html
http://www.ams.sunysb.edu/~xing/tsRbook/data.html
-->

<p><strong>This chapter is heavily based on Chapter 12 of <span class="citation">Chatfield and Xing (<a href="#ref-chatfield2019analysis">2019</a>)</span> and Chapter 3 of <span class="citation">Tsay (<a href="#ref-tsay2010analysis">2010</a>)</span> .</strong></p>
<div id="introduction-1" class="section level2">
<h2><span class="header-section-number">4.1</span> Introduction</h2>
<ul>
<li>Anything that is observed sequentially over time is a time series.</li>
</ul>
<!--Tsay-->
<ul>
<li><strong>Financial time series</strong> analysis focuses on the theory and practice of asset valuation over time.</li>
</ul>
<!--Asset valuation is the process of determining the current value of a company's assets, such as stocks, buildings, equipment, brands, goodwill, etc.

https://www.quora.com/What-is-the-difference-between-time-series-methods-and-financial-time-series-methods
As the names suggest, Financial TS methods are a subset of TS methods.

At the end, Financial TS is times series analysis trying to capture different aspects of financial data that we do not see in general in other economics data.

-->
<ul>
<li>In finance, the data can be collected much more frequently – High frequency data.
<!-- High frequency data provide a rich source of information on the micro-structure of financial markets.-->
<!--Hence, we may need to use continuous time econometrics instead of discrete time.--></li>
<li>Many financial time series also exhibit changing variance and this can have important consequences in formulating financial decisions.</li>
</ul>
<!--Another famous extension in finance is time varying variance and covariances (GARCH, Stochastic Volatility etc).-->
<p><strong>Example: Financial time series</strong></p>
<ul>
<li>Typically, when we analyze assets, we look at the percentage change in prices or returns.</li>
</ul>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" title="1"><span class="co"># Tidy financial analysis </span></a>
<a class="sourceLine" id="cb86-2" title="2"><span class="kw">library</span>(tidyquant)</a>
<a class="sourceLine" id="cb86-3" title="3"></a>
<a class="sourceLine" id="cb86-4" title="4">sp500 &lt;-<span class="st"> </span><span class="kw">tq_get</span>(<span class="st">&quot;^GSPC&quot;</span>, <span class="dt">from =</span> <span class="st">&quot;1995-01-04&quot;</span>, <span class="dt">to =</span> <span class="st">&quot;2021-02-25&quot;</span> )</a>
<a class="sourceLine" id="cb86-5" title="5"><span class="kw">print</span>(sp500)</a></code></pre></div>
<pre><code>## # A tibble: 6,582 x 8
##    symbol date        open  high   low close volume adjusted
##    &lt;chr&gt;  &lt;date&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;
##  1 ^GSPC  1995-01-04  459.  461.  458.  461. 3.20e8     461.
##  2 ^GSPC  1995-01-05  461.  461.  460.  460. 3.09e8     460.
##  3 ^GSPC  1995-01-06  460.  462.  459.  461. 3.08e8     461.
##  4 ^GSPC  1995-01-09  461.  462.  460.  461. 2.79e8     461.
##  5 ^GSPC  1995-01-10  461.  465.  461.  462. 3.52e8     462.
##  6 ^GSPC  1995-01-11  462.  464.  459.  462. 3.46e8     462.
##  7 ^GSPC  1995-01-12  462.  462.  461.  462. 3.13e8     462.
##  8 ^GSPC  1995-01-13  462.  466.  462.  466. 3.37e8     466.
##  9 ^GSPC  1995-01-16  466.  470.  466.  469. 3.16e8     469.
## 10 ^GSPC  1995-01-17  469.  470.  468.  470. 3.32e8     470.
## # … with 6,572 more rows</code></pre>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb88-1" title="1"><span class="co"># Convert each assets raw adjusted closing prices to returns</span></a>
<a class="sourceLine" id="cb88-2" title="2">sp500_return &lt;-<span class="st"> </span>sp500 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb88-3" title="3"><span class="st">  </span><span class="kw">tq_transmute</span>(<span class="dt">select     =</span> adjusted, </a>
<a class="sourceLine" id="cb88-4" title="4">               <span class="dt">mutate_fun =</span> periodReturn, </a>
<a class="sourceLine" id="cb88-5" title="5">               <span class="dt">period     =</span> <span class="st">&quot;daily&quot;</span>)</a>
<a class="sourceLine" id="cb88-6" title="6"></a>
<a class="sourceLine" id="cb88-7" title="7">sp500_return <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb88-8" title="8"><span class="st">  </span><span class="kw">as_tsibble</span>(<span class="dt">index =</span> date) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb88-9" title="9"><span class="st">  </span><span class="kw">autoplot</span>(daily.returns) <span class="op">+</span></a>
<a class="sourceLine" id="cb88-10" title="10"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Day&quot;</span>, <span class="dt">y=</span> <span class="st">&quot;Daily return&quot;</span>)</a></code></pre></div>
<div class="figure"><span id="fig:sp500"></span>
<img src="bookdown-demo_files/figure-html/sp500-1.png" alt="Daily returns of the adjusted closing prices of the Standard &amp; Poor's 500 (S&amp;P500) index from January 4, 1995 to February 25, 2021" width="672" />
<p class="caption">
Figure 4.1: Daily returns of the adjusted closing prices of the Standard &amp; Poor’s 500 (S&amp;P500) index from January 4, 1995 to February 25, 2021
</p>
</div>
<ul>
<li>The mean of the return series seems to be stable with an average return of approximately zero.</li>
<li><p>The volatility of data changes over time.</p></li>
<li>The focus of this chapter is to study some methods and econometric models for modeling the <strong>volatility</strong> (conditional standard deviation) of an asset return. <!--tsay Volatility means the conditional standard deviation of the underlying asset return.--></li>
<li>These models are referred to as <strong>conditional heteroscedastic models</strong>.
<!--https://stats.stackexchange.com/questions/41509/what-is-the-difference-between-garch-and-arma - What is the difference between GARCH and ARMA?--></li>
<li>These models do not generally provide better point forecasts, but provides a better estimates of the (local) variance.</li>
<li>As a result they allow to compute more reliable prediction intervals and therefore a better assessment of risk.</li>
<li>Volatility models have many applications in economics and finance.</li>
<li><p>This chapter discusses various types of <strong>univariate volatility models</strong></p></li>
</ul>
</div>
<div id="structure-of-a-model-for-asset-returns" class="section level2">
<h2><span class="header-section-number">4.2</span> Structure of a Model for Asset Returns</h2>
<ul>
<li><p>Let, <span class="math inline">\(\{P_T\}\)</span>, denotes a time series.</p></li>
<li>Let, <span class="math inline">\(\{Y_T\}\)</span>, denotes a derived series from which any trend and seasonal effects have been removed and linear (short-term correlations) effects may also have been removed.
<ul>
<li>Examples : Let <span class="math inline">\(\{P_T\}\)</span> be share price at the <span class="math inline">\(t\)</span>th trading day.</li>
</ul>
<p><span class="math display">\[Y_t=log P_t - log P_{t-1} \text{  or  } Y_t = \frac{P_t-P_{t-1}}{P_{t-1} }\times100\%\]</span></p></li>
</ul>
<!--$\{Y_T\}$ might be the first differences (or percentage changes) of financial time series such as the natural log of a share price $\{P_T\}$
-->
<ul>
<li>This is often called the <strong>return</strong> or the <strong>growth rate</strong> of a series.</li>
</ul>
<p><strong>Example</strong></p>
<ul>
<li>Let <span class="math inline">\(P_t\)</span> be the adjusted closing prices of the S&amp;P500 at the <span class="math inline">\(t\)</span>th trading day.</li>
<li>Let <span class="math inline">\(Y_t\)</span> be the daily returns of the S&amp;P500 Index at each day as shown in Figure <a href="volatility-models.html#fig:sp500">4.1</a>.</li>
<li>The basic idea in volatility modelling is that the return series <span class="math inline">\(\{Y_t\}\)</span> has very few serial correlations, but it is a dependent series.</li>
<li>Consider the sample ACFs and PACFs of <span class="math inline">\(Y_t\)</span>, <span class="math inline">\(|Y_t|\)</span> and <span class="math inline">\(Y_t^2\)</span> (Figure <a href="volatility-models.html#fig:acf">4.2</a>)</li>
</ul>
<div class="figure"><span id="fig:acf"></span>
<img src="bookdown-demo_files/figure-html/acf-1.png" alt="Sample ACF (left) and sample PACF (right) of various functions of the daily returns, $Y_t$, of adjusted closing prices of S&amp;P500 Index from from January 4, 1995 to February 25, 2021. Top: Original series $Y_t$; Middle: Absolute value of $Y_t$; Bottom: Squared values of $Y_t$." width="672" />
<p class="caption">
Figure 4.2: Sample ACF (left) and sample PACF (right) of various functions of the daily returns, <span class="math inline">\(Y_t\)</span>, of adjusted closing prices of S&amp;P500 Index from from January 4, 1995 to February 25, 2021. Top: Original series <span class="math inline">\(Y_t\)</span>; Middle: Absolute value of <span class="math inline">\(Y_t\)</span>; Bottom: Squared values of <span class="math inline">\(Y_t\)</span>.
</p>
</div>
<ul>
<li>Sample ACFs of the returns <span class="math inline">\(Y_t\)</span> suggest no significant serial correlations except for small ones at lags 1, 3 and 5.</li>
<li>However, the sample ACFs of <span class="math inline">\(|Y_t|\)</span> and <span class="math inline">\(Y_t^2\)</span>, show strong dependence over all lags.</li>
<li>Important feature: the returns may seem serially uncorrelated, but it is dependent.</li>
<li>This is a common observations for daily returns series</li>
</ul>
<!-- 
https://stats.stackexchange.com/questions/325390/serially-uncorrelated-but-dependence-in-arch-model

Serially Uncorrelated but dependence in ARCH model

On the first chart (of raw returns), the ACF does not appear to be significantly non-0 anywhere (other than at lag 1 of course). In other words, there is no serial correlation of the returns.

On the second chart (of squared returns), the ACF does appear to be significantly non-0 at certain lags. So this gives us hope that we can use these squared returns to predict something by using them.

(Interestingly, if you plotted the ACF for absolute returns, you would find something similar to the second chart. This is because the absolute value and the square both discard the sign to measure some sort of "deviation", in the non-technical sense of the word.)

It's not just any series, it's a series of raw returns. And as you saw in the first chart, raw returns are not serially correlated.

However, squared (and absolute) returns are, which is good news! This is because we can now use them to predict "volatility" (i.e. the conditional variance) using ARCH models. And this is what ARCH models do-->
<!-- To focus our discussion on volatility of return series, we may further assume that Yt-->
<p><strong>Volatility of a return series</strong></p>
<ul>
<li>Let <span class="math inline">\(Y_t\)</span> be the innovations in a linear time series model.
<!--  the innovation is the difference between the observed value of a variable at time t and the optimal forecast of that value based on information available prior to time t.

 I conclude that innovations are ok to interchange with errors. It's called innovations because in time series context the errors bring new information to the system.--></li>
<li>Let <span class="math inline">\(X_t\)</span> follow an <span class="math inline">\(ARMA(p,q)\)</span> model,
<span class="math display">\[\phi(B)X_t=\theta(B)Y_t,\]</span></li>
</ul>
<p>where <span class="math inline">\(\phi(B)\)</span> and <span class="math inline">\(\theta(B)\)</span> are polynomials of <span class="math inline">\(B\)</span> with order <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span>, respectively.</p>
<ul>
<li><p>Let <span class="math inline">\(\mathcal{F}_t\)</span>, the set of observed data up to time <span class="math inline">\(t\)</span>, (i.e. <span class="math inline">\(\{X_1,X_2,\dots, X_t\}\)</span>).</p></li>
<li><p>Then the observation <span class="math inline">\(X_t\)</span> can be written as
<span class="math display">\[X_t=\mu_t+Y_t,\]</span>
where <span class="math inline">\(\mu_t\)</span> is the mean of <span class="math inline">\(X_t\)</span> conditional on observed data <span class="math inline">\(\mathcal{F}_{t-1},\)</span></p></li>
</ul>
<p><span class="math display">\[\mu_t=E(X_t|\mathcal{F}_{t-1})= \phi(B)X_t-(\theta(B)-1)Y_t\]</span></p>
<p>and the innovation series <span class="math inline">\(Y_t\)</span> has mean 0 and conditional variance</p>
<p><span class="math display">\[\sigma_t^2=Var(X_t|\mathcal{F}_{t-1})=Var(Y_t|\mathcal{F}_{t-1})\]</span></p>
<ul>
<li>The conditional heteroscedastic models of this chapter are concerned with the evolution of <span class="math inline">\(\sigma_t^2\)</span> over time.</li>
<li>The model for <span class="math inline">\(\mu_t\)</span> is referred to as the mean equation for <span class="math inline">\(X_t\)</span> and the model for <span class="math inline">\(\sigma^2_t\)</span> is the volatility equation for <span class="math inline">\(X_t.\)</span></li>
</ul>
<!--
- A classical linear regression model assumes that the innovation series $Y_t$  has a constant variance.
- The fundamental idea in GARCH is to add a second equation to the standard regression model, the conditional variance equation. 

-->
</div>
<div id="model-building" class="section level2">
<h2><span class="header-section-number">4.3</span> Model Building</h2>
<!--Tsay: Analysis of financial ts pg 113-->
<p>The process of building a volatility model for an asset return series consists of four main steps <span class="citation">(Tsay <a href="#ref-tsay2010analysis">2010</a>)</span>:</p>
<ol style="list-style-type: decimal">
<li>Specify a mean equation by testing for serial dependence in the data and, if necessary, building an econometric model (e.g., an ARMA model) for the return series to remove any linear dependence.</li>
<li>Use the residuals of the mean equation to test for ARCH effects.</li>
<li>Specify a volatility model if ARCH effects are statistically significant, and perform a joint estimation of the mean and volatility equations.</li>
<li>Check the fitted model carefully and refine it if necessary.</li>
</ol>
</div>
<div id="testing-for-arch-effect" class="section level2">
<h2><span class="header-section-number">4.4</span> Testing for ARCH Effect</h2>
<ul>
<li>Let <span class="math inline">\(Y_t = X_t − \mu_t\)</span> be the residuals of the mean equation.</li>
<li>The squared series <span class="math inline">\(Y_t^2\)</span> is then used to check for <strong>conditional heteroscedasticity</strong> (also known as the <strong>ARCH effects</strong>).</li>
<li>Volatility clustering implies a strong autocorrelation in squared series.</li>
<li>There are two statistical tests for conditional heteroscedasticity
<ol style="list-style-type: decimal">
<li><p>Method 1: Apply the usual Ljung–Box statistics <span class="math inline">\(Q(m)\)</span> to the <span class="math inline">\(Y_t^2\)</span> (McLeod and Li, 1983).</p>
<ul>
<li>The null hypothesis is that the first <span class="math inline">\(m\)</span> lags of ACF of the <span class="math inline">\(Y_t^2\)</span> series are zero.</li>
</ul></li>
<li><p>Method 2: The Lagrange multiplier test of Engle (1982).</p></li>
</ol></li>
</ul>
</div>
<div id="autoregressive-conditional-heteroskedastic-arch-models" class="section level2">
<h2><span class="header-section-number">4.5</span> Autoregressive Conditional Heteroskedastic (ARCH) Models</h2>
<ul>
<li><p>ARCH model of Engle (1982) is the first model that provides a systematic framework for volatility modeling.</p></li>
<li><p>Main idea:</p>
<ol style="list-style-type: lower-alpha">
<li><span class="math inline">\(Y_t\)</span> is serially uncorrelated, but dependent,<br />
</li>
<li>the dependence of <span class="math inline">\(Y_t\)</span> can be described by a simple quadratic function of its lagged values.</li>
</ol></li>
<li><p>To better describe the idea, we represents <span class="math inline">\(Y_t\)</span> having a zero means in the form</p></li>
</ul>
<p><span class="math display">\[\begin{equation} \label{eq:1}
Y_t=\sigma_t\epsilon_t,
\end{equation}\]</span></p>
<p><span class="math display">\[\begin{equation} \label{eq:2}
\sigma_t^2 =\alpha_0+\alpha_1Y_{t-1}^2+\dots+\alpha_mY_{t-m}^2,
\end{equation}\]</span></p>
<p>where <span class="math inline">\(\{\epsilon_t\}\)</span> is a sequence of iid random variables with mean zero and variance 1.</p>
<ul>
<li><span class="math inline">\(\sigma_t\)</span> can be thought of as the local conditional standard deviation of the process.</li>
<li><span class="math inline">\(\alpha_0&gt;0\)</span>, and <span class="math inline">\(\alpha_i\geq0\)</span> for <span class="math inline">\(i &gt; 0\)</span>.</li>
<li>To ensure that the unconditional variance of <span class="math inline">\(Y_t\)</span> is finite, coefficients <span class="math inline">\(\alpha_i\)</span> must satisfy some regularity conditions.</li>
<li>The <span class="math inline">\(\epsilon_t\)</span> may follow the standard normal or a standardized Student-t or a generalized error distribution.</li>
</ul>
<!--From the structure of the model, it is seen that large past squared shocks {a2 }m t−i i=1
imply a large conditional variance σt2 for the innovation at . Consequently, at tends to assume a large value (in modulus). This means that, under the ARCH framework, large shocks tend to be followed by another large shock. Here I use the word tend because a large variance does not necessarily produce a large realization. It only says that the probability of obtaining a large variate is greater than that of a smaller variance. This feature is similar to the volatility clustering observed in asset returns.-->
<ul>
<li>A model for <span class="math inline">\(Y_t\)</span> satisfying Equations  and  is called an <strong>autoregressive conditional heteroskedastic model</strong> of order <span class="math inline">\(m\)</span> (<span class="math inline">\(ARCH(m)\)</span>)</li>
<li>Note that Equation  does not include an ‘error’ term and therefore does not define a stochastic process.</li>
<li><p>The ARCH model allows for volatility clustering as the conditional variance <span class="math inline">\(\sigma_t^2\)</span> in Equation  depends on the lagged squared innovations <span class="math inline">\(Y^2_{t−1}\)</span>. A large (positive or negative) residual at time <span class="math inline">\(t − 1\)</span> implies that <span class="math inline">\(Y^2_{t−1}\)</span> is large and consequently the conditional variance <span class="math inline">\(\sigma_t^2\)</span> will be large as <span class="math inline">\(\alpha_i ≥ 0\)</span>. Thereby, large shocks tend to be followed by large shocks (in absolute terms) and small shocks tend to be followed by small shocks (in absolute terms). This is the feature we call <strong>volatility clustering</strong>.</p></li>
<li><p>However, large variance does not necessarily produce a large <strong>realization</strong>. It only says that the <strong>probability</strong> of obtaining a large variate is greater than that of a smaller variance.</p></li>
</ul>
<div id="example-building-an-arch-model" class="section level3">
<h3><span class="header-section-number">4.5.1</span> Example: Building an ARCH Model</h3>
<ul>
<li><p>Let’s apply the modeling procedure to build a simple ARCH model for the daily returns, <span class="math inline">\(X_t,\)</span>, of adjusted closing prices of the S&amp;P500 index.</p></li>
<li>Figure <a href="volatility-models.html#fig:sp500">4.1</a> shows the daily return series from January 4, 1995 to February 25, 2021.</li>
<li>The sample ACF and PACF of the squared returns in the bottom panel of Figure <a href="volatility-models.html#fig:acf">4.2</a>, show the existence of conditional heteroscedasticity.</li>
<li>If an ARCH effect is found to be significant, one can use the PACF of <span class="math inline">\(Y_t^2\)</span> to determine the ARCH order.</li>
<li><p>We consider an ARCH(2) model with the following specification for the daily return series</p></li>
</ul>
<p><span class="math display">\[X_t=\mu+Y_t,\]</span>
<span class="math display">\[Y_t=\sigma_t\epsilon_t,\]</span>
<span class="math display">\[\sigma_t^2=\alpha_0+\alpha_1Y_{t-1}^2 + \alpha_2Y_{t-2}^2.\]</span></p>
<ul>
<li>We use the R function <code>garchFit</code> in the R package <code>fGarch</code> to estimate the model.</li>
</ul>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb89-1" title="1"><span class="co"># install.packages(&quot;fGarch&quot;)</span></a>
<a class="sourceLine" id="cb89-2" title="2"><span class="kw">library</span>(fGarch)</a>
<a class="sourceLine" id="cb89-3" title="3">fit1 &lt;-<span class="st"> </span><span class="kw">garchFit</span>(<span class="op">~</span><span class="kw">garch</span>(<span class="dv">2</span>,<span class="dv">0</span>), <span class="dt">data =</span>sp500_return<span class="op">$</span>daily.returns)</a>
<a class="sourceLine" id="cb89-4" title="4"><span class="kw">summary</span>(fit1)</a></code></pre></div>
<pre><code>## 
## Title:
##  GARCH Modelling 
## 
## Call:
##  garchFit(formula = ~garch(2, 0), data = sp500_return$daily.returns) 
## 
## Mean and Variance Equation:
##  data ~ garch(2, 0)
## &lt;environment: 0x7fadb53fae90&gt;
##  [data = sp500_return$daily.returns]
## 
## Conditional Distribution:
##  norm 
## 
## Coefficient(s):
##         mu       omega      alpha1      alpha2  
## 7.7804e-04  5.8828e-05  2.2118e-01  3.8733e-01  
## 
## Std. Errors:
##  based on Hessian 
## 
## Error Analysis:
##         Estimate  Std. Error  t value Pr(&gt;|t|)    
## mu     7.780e-04   1.098e-04    7.087 1.37e-12 ***
## omega  5.883e-05   1.818e-06   32.366  &lt; 2e-16 ***
## alpha1 2.212e-01   1.967e-02   11.245  &lt; 2e-16 ***
## alpha2 3.873e-01   2.368e-02   16.354  &lt; 2e-16 ***
## ---
## Signif. codes:  
## 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Log Likelihood:
##  20748    normalized:  3.152 
## 
## Description:
##  Sat Feb 27 13:39:26 2021 by user:  
## 
## 
## Standardised Residuals Tests:
##                                 Statistic p-Value 
##  Jarque-Bera Test   R    Chi^2  2657      0       
##  Shapiro-Wilk Test  R    W      NA        NA      
##  Ljung-Box Test     R    Q(10)  21.61     0.01721 
##  Ljung-Box Test     R    Q(15)  34.45     0.002941
##  Ljung-Box Test     R    Q(20)  38.39     0.007933
##  Ljung-Box Test     R^2  Q(10)  362.7     0       
##  Ljung-Box Test     R^2  Q(15)  546.8     0       
##  Ljung-Box Test     R^2  Q(20)  713.2     0       
##  LM Arch Test       R    TR^2   428.5     0       
## 
## Information Criterion Statistics:
##    AIC    BIC    SIC   HQIC 
## -6.303 -6.299 -6.303 -6.302</code></pre>
<p><strong>Plot the result</strong></p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb91-1" title="1">sp500_return &lt;-<span class="st"> </span>sp500_return <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb91-2" title="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">vol =</span> <span class="kw">volatility</span>(fit1),</a>
<a class="sourceLine" id="cb91-3" title="3">         <span class="dt">resid.st =</span> <span class="kw">residuals</span>(fit1, <span class="dt">standardize=</span>T)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb91-4" title="4"><span class="st">  </span><span class="kw">as_tsibble</span>(<span class="dt">index =</span> date, <span class="dt">regular =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb91-5" title="5"></a>
<a class="sourceLine" id="cb91-6" title="6">p1 &lt;-<span class="st"> </span>sp500_return <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">autoplot</span>(vol)</a>
<a class="sourceLine" id="cb91-7" title="7">p2 &lt;-<span class="st"> </span>sp500_return <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">autoplot</span>(resid.st)  </a>
<a class="sourceLine" id="cb91-8" title="8">p3 &lt;-<span class="st"> </span>sp500_return <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ACF</span>(resid.st) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">autoplot</span>()</a>
<a class="sourceLine" id="cb91-9" title="9">p4 &lt;-<span class="st"> </span>sp500_return <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">PACF</span>(resid.st) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">autoplot</span>()</a>
<a class="sourceLine" id="cb91-10" title="10">p5 &lt;-<span class="st"> </span>sp500_return <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ACF</span>(resid.st<span class="op">^</span><span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">autoplot</span>()</a>
<a class="sourceLine" id="cb91-11" title="11">p6 &lt;-<span class="st"> </span>sp500_return <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">PACF</span>(resid.st<span class="op">^</span><span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">autoplot</span>()</a></code></pre></div>
<div class="figure"><span id="fig:plot2"></span>
<img src="bookdown-demo_files/figure-html/plot2-1.png" alt="(a) Estimated volatility $\hat{\sigma_t}$, (b) the standardized residual $\hat{\epsilon_t}$, (c) sample ACF of $\hat{\epsilon_t}$,  (d) sample PACF of $\hat{\epsilon_t}$, (e) sample ACF of $\hat{\epsilon_t^2}$,  (d) sample PACF of $\hat{\epsilon_t^2}$, in the ARCH(2) model for daily returns of adjusted closing prices of the S&amp;P500 Index from January 4, 1995 to February 25, 2021." width="672" />
<p class="caption">
Figure 4.3: (a) Estimated volatility <span class="math inline">\(\hat{\sigma_t}\)</span>, (b) the standardized residual <span class="math inline">\(\hat{\epsilon_t}\)</span>, (c) sample ACF of <span class="math inline">\(\hat{\epsilon_t}\)</span>, (d) sample PACF of <span class="math inline">\(\hat{\epsilon_t}\)</span>, (e) sample ACF of <span class="math inline">\(\hat{\epsilon_t^2}\)</span>, (d) sample PACF of <span class="math inline">\(\hat{\epsilon_t^2}\)</span>, in the ARCH(2) model for daily returns of adjusted closing prices of the S&amp;P500 Index from January 4, 1995 to February 25, 2021.
</p>
</div>
<div style="page-break-after: always;"></div>
<ul>
<li>Assuming that <span class="math inline">\(\epsilon_t\)</span> are iid, standard normal, we get the fitted model as follows:</li>
</ul>
<p><span class="math display">\[X_t = 0.0007804_{(1.098e-04)} + Y_t, \text{  }Y_t=\sigma_t\epsilon_t,\]</span></p>
<p><span class="math display">\[\sigma_t^2=0.00005883_{(1.818e-06)}+0.2212_{(1.967e-02)}Y_{t-1}^2 + 0.3873_{(2.368e-02)}Y_{t-2}^2\]</span></p>
<p>where the standard errors of the parameters are given in the parentheses.</p>
<ul>
<li>Both the output and the plot show that the estimated residuals still have conditional heteroscedasticities.</li>
<li>Therefore, the ARCH(2) model is not adequate.</li>
</ul>
</div>
</div>
<div id="generalized-arch-garch-models" class="section level2">
<h2><span class="header-section-number">4.6</span> Generalized ARCH (GARCH) Models</h2>
<ul>
<li><p>Although the ARCH model is simple, it often requires many parameters to adequately describe the volatility process of an asset return.</p></li>
<li><p>Bollerslev (1986) proposes a useful extension known as the generalized ARCH (GARCH) model.</p></li>
<li><p>The ARCH model has been generalized to allow the variance to depend on past values of <span class="math inline">\(Y_t^2\)</span> as well as on past values of <span class="math inline">\(\sigma^2_t.\)</span></p></li>
<li><p>A model for <span class="math inline">\(Y_t\)</span> satisfying Equations  is said to follow a <strong>generalized ARCH (or GARCH) model</strong> of order <span class="math inline">\((m,s)\)</span> (<span class="math inline">\(GARCH(m,s)\)</span>) when the local conditional variance is given by</p></li>
</ul>
<p><span class="math display">\[\begin{equation} \label{eq:3}
\sigma_t^2 =\alpha_0+\sum_{i=1}^m\alpha_iY_{t-i}^2+\sum_{j=1}^s\beta_j\sigma_{t-j}^2,
\end{equation}\]</span></p>
<p>where <span class="math inline">\(\{\epsilon_t\}\)</span> is a sequence of iid random variables with mean 0 and variance 1, <span class="math inline">\(\alpha_0&gt;0,\)</span> <span class="math inline">\(\alpha_i\geq0,\)</span> <span class="math inline">\(\beta_j\geq0,\)</span> and
<span class="math inline">\(\sum_{i=1}^{max(m,s)}(\alpha_i+\beta_i)&lt;1.\)</span></p>
<ul>
<li><p>Here, <span class="math inline">\(\alpha_i=0\)</span> for <span class="math inline">\(i&gt;m\)</span> and <span class="math inline">\(\beta_j =0\)</span> for <span class="math inline">\(j&gt;s.\)</span></p></li>
<li><p>The constraint on <span class="math inline">\(\alpha_i+\beta_j\)</span> implies that the unconditional variance of <span class="math inline">\(Y_t\)</span> is finite, whereas its conditional variance <span class="math inline">\(\sigma_t^2\)</span> evolves over time.</p></li>
<li><p><span class="math inline">\(\epsilon_t\)</span> is often assumed to follow a standard normal or standardized Student-t distribution or generalized error distribution.</p></li>
<li><p>Equation  reduces to a pure ARCH(<span class="math inline">\(m\)</span>) model if <span class="math inline">\(s = 0\)</span> (i.e. GARCH(<span class="math inline">\(m,0\)</span>)).</p></li>
<li><p>The <span class="math inline">\(\alpha_i\)</span> and <span class="math inline">\(\beta_j\)</span> are known as ARCH and GARCH parameters, respectively.</p></li>
</ul>
<p>To understand properties of GARCH models, it is informative to use the following representation.</p>
<ul>
<li>Let <span class="math inline">\(\eta_t = Y_t^2 − \sigma_t^2.\)</span></li>
<li>Then <span class="math inline">\(\sigma_t^2= Y_t^2 −\eta_t.\)</span></li>
<li>By plugging <span class="math inline">\(\sigma_{t-1}^2= Y_{t-1}^2 −\eta_{t-1}\)</span> (<span class="math inline">\(i=0,\dots,s\)</span>) into Equation , we get the GARCH model as</li>
</ul>
<p><span class="math display">\[\begin{equation} \label{eq:4}
Y_t^2 =\alpha_0+\sum_{i=1}^{max(m,s)}(\alpha_i+\beta_i)Y_{t-i}^2+\eta_t-\sum_{j=1}^s\beta_j\eta_{t-j}.
\end{equation}\]</span></p>
<ul>
<li>It is easy to check that <span class="math inline">\(\{\eta_t \}\)</span> is a martingale difference series [i.e., <span class="math inline">\(E(\eta_t ) = 0\)</span> and <span class="math inline">\(cov(\eta_t , \eta_{t-j} ) = 0\)</span> for <span class="math inline">\(j\geq 1\)</span>].</li>
<li>However, <span class="math inline">\(\{\eta_t \}\)</span> in general is not an iid sequence.</li>
<li>Equation  is an ARMA form for the squared series <span class="math inline">\(Y_t^2\)</span>.</li>
<li>Therefore, a GARCH model can be regarded as an application of the ARMA idea to the squared series <span class="math inline">\(Y_t^2\)</span>.</li>
<li>Therefore, the same invertibility and stationary assumptions of ARMA models apply to GARCh models.</li>
<li>For example, <span class="math inline">\(Y_t\)</span> is covariance stationary, if all roots of <span class="math inline">\(1-\sum_{j=1}^{max(m,s)}(\alpha_j+\beta_j)z^j=0\)</span> lie outside the unit circle.</li>
</ul>
<p><strong>GARCH(<span class="math inline">\(1,1\)</span>) model</strong></p>
<ul>
<li>The <span class="math inline">\(GARCH(1,1)\)</span> model is often used to fit financial time series.</li>
<li>The properties of GARCH models can easily be understood by focusing
on the simplest <span class="math inline">\(GARCH(1,1)\)</span> model with</li>
</ul>
<p><span class="math display">\[\sigma_t^2 = \alpha_0+\alpha_1Y_{t-1}^2 + \beta_1\sigma_{t-1}^2, \text{  } 0\leq\alpha_1, \beta_1\leq 1, (\alpha_1+\beta_1)&lt;1.\]</span></p>
<ul>
<li>The model implies that a large <span class="math inline">\(Y_{t-1}^2\)</span> or <span class="math inline">\(\sigma_{t-1}^2\)</span> will lead to a large <span class="math inline">\(\sigma_{t}^2\)</span>, which in turn will give rise to a large <span class="math inline">\(Y_t^2=\sigma_t^2\epsilon_t^2.\)</span></li>
<li>This again generate the well-known behaviour of volatility clustering in financial time series.</li>
</ul>
<div id="prediction-of-volatilities" class="section level3">
<h3><span class="header-section-number">4.6.1</span> Prediction of volatilities</h3>
<ul>
<li>Both ARCH and GARCH models do not affect point forecasts of the original observed variables.</li>
<li>Therefore, it is difficult to make a fair comparison of the forecasting abilities of different models for changing variance.</li>
<li>Therefore, both the modeling aspect (understanding the changing structure of a series), and the assessment of risk, are more important than their ability to make point forecasts.</li>
<li>Forecasts of a GARCH model are similar to those of an ARMA model.</li>
<li>Consider the GARCH(1,1) model.</li>
<li>Let the forecast origin is <span class="math inline">\(h\)</span>.</li>
<li>For 1-step ahead forecast, we have</li>
</ul>
<p><span class="math display">\[\sigma_{h+1}^2 = \alpha_0+\alpha_1Y_h^2+\beta_1\sigma_h^2\]</span>
where <span class="math inline">\(Y_h\)</span> and <span class="math inline">\(\sigma_h^2\)</span> are known at the time index <span class="math inline">\(h\)</span>.</p>
<ul>
<li>Then, 1-step ahead forecast is</li>
</ul>
<p><span class="math display">\[\sigma_{h}^2(1) = \alpha_0+\alpha_1Y_h^2+\beta_1\sigma_h^2.\]</span></p>
<ul>
<li>For multistep-ahead forecasts, we use <span class="math inline">\(Y_t^2 = \sigma_t^2\epsilon_t^2.\)</span></li>
<li>Then the volatility equation can be written as</li>
</ul>
<p><span class="math display">\[\sigma_{t+1}^2 = \alpha_0+(\alpha_1+\beta_1)\sigma_t^2+\alpha_1\sigma_t^2(\epsilon_t^2-1).\]</span>
- When <span class="math inline">\(t = h + 1\)</span>, we get,</p>
<p><span class="math display">\[\sigma_{h+2}^2 = \alpha_0+(\alpha_1+\beta_1)\sigma_{h+1}^2+\alpha_1\sigma_{h+1}^2(\epsilon_{h+1}^2-1).\]</span>
- Since <span class="math inline">\(E(\epsilon_{h+1}^2-1|\mathcal{F}_t)=0\)</span>, the 2-step-ahead volatility forecast at the forecast origin <span class="math inline">\(h\)</span> satisfies the equation</p>
<p><span class="math display">\[\sigma_{h}^2(2) = \alpha_0+(\alpha_1+\beta_1)\sigma_h^2(1).\]</span></p>
<ul>
<li><p>In general, we can write
<span class="math display">\[\sigma_{h}^2(k) = \alpha_0+(\alpha_1+\beta_1)\sigma_h^2(k-1), \quad k&gt;1.\]</span></p></li>
<li><p>This result is similar to an ARMA(1,1) model with AR polynomial <span class="math inline">\(1 − (\alpha_1 + \beta_1)B\)</span>.</p></li>
</ul>
</div>
<div id="example-building-a-garch-model" class="section level3">
<h3><span class="header-section-number">4.6.2</span> Example: Building a GARCH Model</h3>
<ul>
<li>Let’s apply the modeling procedure to build a <span class="math inline">\(GARCH(1,1)\)</span> model for the daily returns, <span class="math inline">\(X_t\)</span>, of adjusted closing prices of the S&amp;P500 index.</li>
<li>Figure <a href="volatility-models.html#fig:sp500">4.1</a> shows the daily return series from January 4, 1995 to February 25, 2021.</li>
<li>The sample ACF and PACF of the squared returns in the bottom panel of Figure <a href="volatility-models.html#fig:acf">4.2</a>, show the existence of conditional heteroscedasticity.</li>
</ul>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb92-1" title="1">fit2 &lt;-<span class="st"> </span><span class="kw">garchFit</span>(<span class="op">~</span><span class="kw">garch</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="dt">data =</span>sp500_return<span class="op">$</span>daily.returns)</a>
<a class="sourceLine" id="cb92-2" title="2"><span class="kw">summary</span>(fit2)</a></code></pre></div>
<pre><code>## 
## Title:
##  GARCH Modelling 
## 
## Call:
##  garchFit(formula = ~garch(1, 1), data = sp500_return$daily.returns) 
## 
## Mean and Variance Equation:
##  data ~ garch(1, 1)
## &lt;environment: 0x7fddd338b750&gt;
##  [data = sp500_return$daily.returns]
## 
## Conditional Distribution:
##  norm 
## 
## Coefficient(s):
##         mu       omega      alpha1       beta1  
## 7.2933e-04  2.1055e-06  1.2134e-01  8.6479e-01  
## 
## Std. Errors:
##  based on Hessian 
## 
## Error Analysis:
##         Estimate  Std. Error  t value Pr(&gt;|t|)    
## mu     7.293e-04   9.722e-05    7.502 6.28e-14 ***
## omega  2.106e-06   2.656e-07    7.927 2.22e-15 ***
## alpha1 1.213e-01   8.705e-03   13.940  &lt; 2e-16 ***
## beta1  8.648e-01   8.885e-03   97.335  &lt; 2e-16 ***
## ---
## Signif. codes:  
## 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Log Likelihood:
##  21322    normalized:  3.239 
## 
## Description:
##  Sat Feb 27 16:30:00 2021 by user:  
## 
## 
## Standardised Residuals Tests:
##                                 Statistic p-Value 
##  Jarque-Bera Test   R    Chi^2  1195      0       
##  Shapiro-Wilk Test  R    W      NA        NA      
##  Ljung-Box Test     R    Q(10)  21.65     0.01699 
##  Ljung-Box Test     R    Q(15)  30.7      0.009632
##  Ljung-Box Test     R    Q(20)  34.98     0.0202  
##  Ljung-Box Test     R^2  Q(10)  12.97     0.2255  
##  Ljung-Box Test     R^2  Q(15)  16.83     0.329   
##  Ljung-Box Test     R^2  Q(20)  17.81     0.5999  
##  LM Arch Test       R    TR^2   13.93     0.3055  
## 
## Information Criterion Statistics:
##    AIC    BIC    SIC   HQIC 
## -6.478 -6.473 -6.478 -6.476</code></pre>
<p><strong>Plot the result</strong></p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb94-1" title="1">sp500_return &lt;-<span class="st"> </span>sp500_return <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb94-2" title="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">vol =</span> <span class="kw">volatility</span>(fit2),</a>
<a class="sourceLine" id="cb94-3" title="3">         <span class="dt">resid.st =</span> <span class="kw">residuals</span>(fit2, <span class="dt">standardize=</span>T)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb94-4" title="4"><span class="st">  </span><span class="kw">as_tsibble</span>(<span class="dt">index =</span> date, <span class="dt">regular =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb94-5" title="5"></a>
<a class="sourceLine" id="cb94-6" title="6">p1 &lt;-<span class="st"> </span>sp500_return <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">autoplot</span>(vol)</a>
<a class="sourceLine" id="cb94-7" title="7">p2 &lt;-<span class="st"> </span>sp500_return <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">autoplot</span>(resid.st)  </a>
<a class="sourceLine" id="cb94-8" title="8">p3 &lt;-<span class="st"> </span>sp500_return <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ACF</span>(resid.st) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">autoplot</span>()</a>
<a class="sourceLine" id="cb94-9" title="9">p4 &lt;-<span class="st"> </span>sp500_return <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">PACF</span>(resid.st) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">autoplot</span>()</a>
<a class="sourceLine" id="cb94-10" title="10">p5 &lt;-<span class="st"> </span>sp500_return <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ACF</span>(resid.st<span class="op">^</span><span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">autoplot</span>()</a>
<a class="sourceLine" id="cb94-11" title="11">p6 &lt;-<span class="st"> </span>sp500_return <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">PACF</span>(resid.st<span class="op">^</span><span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">autoplot</span>()</a></code></pre></div>
<div class="figure"><span id="fig:plot4"></span>
<img src="bookdown-demo_files/figure-html/plot4-1.png" alt="(a) Estimated volatility $\hat{\sigma_t}$, (b) the standardized residual $\hat{\epsilon_t}$, (c) sample ACF of $\hat{\epsilon_t}$,  (d) sample PACF of $\hat{\epsilon_t}$, (e) sample ACF of $\hat{\epsilon_t^2}$,  (d) sample PACF of $\hat{\epsilon_t^2}$, in the GARCH(1,1) model for daily returns of adjusted closing prices of the S&amp;P500 Index from January 4, 1995 to February 25, 2021." width="672" />
<p class="caption">
Figure 4.4: (a) Estimated volatility <span class="math inline">\(\hat{\sigma_t}\)</span>, (b) the standardized residual <span class="math inline">\(\hat{\epsilon_t}\)</span>, (c) sample ACF of <span class="math inline">\(\hat{\epsilon_t}\)</span>, (d) sample PACF of <span class="math inline">\(\hat{\epsilon_t}\)</span>, (e) sample ACF of <span class="math inline">\(\hat{\epsilon_t^2}\)</span>, (d) sample PACF of <span class="math inline">\(\hat{\epsilon_t^2}\)</span>, in the GARCH(1,1) model for daily returns of adjusted closing prices of the S&amp;P500 Index from January 4, 1995 to February 25, 2021.
</p>
</div>
<ul>
<li>Now the model is adequate as the standardized residuals in the fitted <span class="math inline">\(GARCH(1,1)\)</span> model show little conditional heteroscedasticity.</li>
</ul>
<!--https://www.rdocumentation.org/packages/fGarch/versions/3042.83.2/topics/predict-methods-->
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" title="1"><span class="co">## predict </span></a>
<a class="sourceLine" id="cb95-2" title="2"><span class="kw">predict</span>(fit2, <span class="dt">n.ahead =</span> <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb95-3" title="3"></a>
<a class="sourceLine" id="cb95-4" title="4"><span class="co">## predict with plotting</span></a>
<a class="sourceLine" id="cb95-5" title="5"><span class="co">## 95% confidence level</span></a>
<a class="sourceLine" id="cb95-6" title="6"><span class="kw">predict</span>(fit2, <span class="dt">n.ahead =</span> <span class="dv">10</span>, <span class="dt">plot=</span><span class="ot">TRUE</span>, <span class="dt">conf=</span>.<span class="dv">95</span>)</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-45-1.png" width="672" /></p>
</div>
</div>
<div id="the-arma-garch-models" class="section level2">
<h2><span class="header-section-number">4.7</span> The ARMA-GARCH Models</h2>
<ul>
<li>The dynamics of asset returns and their volatility can be modeled by combining GARCH models with the linear time series models discussed in Chapter 2.</li>
<li>Let <span class="math inline">\(X_t\)</span> follows an ARMA model with GARCH innovations.</li>
<li>Then, it yields the following <span class="math inline">\(ARMA(p,q)-GARCH(m,s)\)</span> model for <span class="math inline">\((X_t, \sigma_t):\)</span></li>
</ul>
<p><span class="math display">\[X_t=\mu+\sum_{i=1}^p\phi_iX_{t-i}+\sum_{j=1}^q\theta_jY_{t-j} + Y_t, \quad Y_t=\sigma_t\epsilon_t,\]</span></p>
<p><span class="math display">\[\sigma^2_t=\alpha_0+
\sum_{i=1}^m\alpha_iY_{t-i}^2+\sum_{j=1}^s\beta_j\sigma_{t-j}^2.\]</span></p>
<ul>
<li>The <span class="math inline">\(\epsilon_t\)</span> are iid standard normal or Student-t random variables.</li>
<li>The second equation can be replaced by other volatility models so that different aspects of volatilities can be characterized.</li>
</ul>
<div id="example-building-an-arma-garch-model" class="section level3">
<h3><span class="header-section-number">4.7.1</span> Example: Building an ARMA-GARCH Model</h3>
<ul>
<li>Let’s apply the modeling procedure to build an <span class="math inline">\(ARMA(1,1)-GARCH(1,1)\)</span> model for the daily returns, <span class="math inline">\(X_t,\)</span> of adjusted closing prices of the S&amp;P500 index</li>
</ul>
<p><span class="math display">\[X_t = \mu + \phi X_{t-1}+\theta Y_{t-1} + Y_t,\]</span>
<span class="math display">\[Y_t= \sigma_t\epsilon_t,\]</span></p>
<p><span class="math display">\[\sigma_t^2=\alpha_0+\alpha Y_{t-1}^2+\beta\sigma_{t-1}^2.\]</span></p>
<ul>
<li>Let <span class="math inline">\(\epsilon_t\)</span> are iid standard normal.</li>
</ul>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb96-1" title="1">fit3 &lt;-<span class="st"> </span><span class="kw">garchFit</span>(<span class="op">~</span><span class="kw">arma</span>(<span class="dv">1</span>,<span class="dv">1</span>)<span class="op">+</span><span class="kw">garch</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="dt">data =</span>sp500_return<span class="op">$</span>daily.returns)</a>
<a class="sourceLine" id="cb96-2" title="2"><span class="kw">summary</span>(fit3)</a></code></pre></div>
<pre><code>## 
## Title:
##  GARCH Modelling 
## 
## Call:
##  garchFit(formula = ~arma(1, 1) + garch(1, 1), data = sp500_return$daily.returns) 
## 
## Mean and Variance Equation:
##  data ~ arma(1, 1) + garch(1, 1)
## &lt;environment: 0x7fa4b68f4ad8&gt;
##  [data = sp500_return$daily.returns]
## 
## Conditional Distribution:
##  norm 
## 
## Coefficient(s):
##          mu          ar1          ma1        omega  
##  8.7477e-05   8.8353e-01  -9.1463e-01   2.0642e-06  
##      alpha1        beta1  
##  1.1989e-01   8.6645e-01  
## 
## Std. Errors:
##  based on Hessian 
## 
## Error Analysis:
##          Estimate  Std. Error  t value Pr(&gt;|t|)    
## mu      8.748e-05   4.726e-05    1.851   0.0642 .  
## ar1     8.835e-01   6.139e-02   14.392  &lt; 2e-16 ***
## ma1    -9.146e-01   5.330e-02  -17.160  &lt; 2e-16 ***
## omega   2.064e-06   2.603e-07    7.932 2.22e-15 ***
## alpha1  1.199e-01   8.565e-03   13.997  &lt; 2e-16 ***
## beta1   8.664e-01   8.736e-03   99.186  &lt; 2e-16 ***
## ---
## Signif. codes:  
## 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Log Likelihood:
##  21335    normalized:  3.241 
## 
## Description:
##  Sat Feb 27 20:47:32 2021 by user:  
## 
## 
## Standardised Residuals Tests:
##                                 Statistic p-Value
##  Jarque-Bera Test   R    Chi^2  1279      0      
##  Shapiro-Wilk Test  R    W      NA        NA     
##  Ljung-Box Test     R    Q(10)  13.06     0.2206 
##  Ljung-Box Test     R    Q(15)  22.45     0.09663
##  Ljung-Box Test     R    Q(20)  28.44     0.09946
##  Ljung-Box Test     R^2  Q(10)  14.88     0.1364 
##  Ljung-Box Test     R^2  Q(15)  18.44     0.2403 
##  Ljung-Box Test     R^2  Q(20)  19.64     0.4806 
##  LM Arch Test       R    TR^2   15.35     0.2229 
## 
## Information Criterion Statistics:
##    AIC    BIC    SIC   HQIC 
## -6.481 -6.475 -6.481 -6.479</code></pre>
<p><strong>Plot the result</strong></p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb98-1" title="1">sp500_return &lt;-<span class="st"> </span>sp500_return <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb98-2" title="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">vol =</span> <span class="kw">volatility</span>(fit3),</a>
<a class="sourceLine" id="cb98-3" title="3">         <span class="dt">resid.st =</span> <span class="kw">residuals</span>(fit3, <span class="dt">standardize=</span>T)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb98-4" title="4"><span class="st">  </span><span class="kw">as_tsibble</span>(<span class="dt">index =</span> date, <span class="dt">regular =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb98-5" title="5"></a>
<a class="sourceLine" id="cb98-6" title="6">p1 &lt;-<span class="st"> </span>sp500_return <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">autoplot</span>(vol)</a>
<a class="sourceLine" id="cb98-7" title="7">p2 &lt;-<span class="st"> </span>sp500_return <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">autoplot</span>(resid.st)  </a>
<a class="sourceLine" id="cb98-8" title="8">p3 &lt;-<span class="st"> </span>sp500_return <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ACF</span>(resid.st) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">autoplot</span>()</a>
<a class="sourceLine" id="cb98-9" title="9">p4 &lt;-<span class="st"> </span>sp500_return <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">PACF</span>(resid.st) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">autoplot</span>()</a>
<a class="sourceLine" id="cb98-10" title="10">p5 &lt;-<span class="st"> </span>sp500_return <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ACF</span>(resid.st<span class="op">^</span><span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">autoplot</span>()</a>
<a class="sourceLine" id="cb98-11" title="11">p6 &lt;-<span class="st"> </span>sp500_return <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">PACF</span>(resid.st<span class="op">^</span><span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">autoplot</span>()</a></code></pre></div>
<div class="figure"><span id="fig:plotag2"></span>
<img src="bookdown-demo_files/figure-html/plotag2-1.png" alt="(a) Estimated volatility $\hat{\sigma_t}$, (b) the standardized residual $\hat{\epsilon_t}$, (c) sample ACF of $\hat{\epsilon_t}$,  (d) sample PACF of $\hat{\epsilon_t}$, (e) sample ACF of $\hat{\epsilon_t^2}$,  (d) sample PACF of $\hat{\epsilon_t^2}$, in the ARMA(1,1)-GARCH(1,1) model for daily returns of adjusted closing prices of the S&amp;P500 Index from January 4, 1995 to February 25, 2021." width="672" />
<p class="caption">
Figure 4.5: (a) Estimated volatility <span class="math inline">\(\hat{\sigma_t}\)</span>, (b) the standardized residual <span class="math inline">\(\hat{\epsilon_t}\)</span>, (c) sample ACF of <span class="math inline">\(\hat{\epsilon_t}\)</span>, (d) sample PACF of <span class="math inline">\(\hat{\epsilon_t}\)</span>, (e) sample ACF of <span class="math inline">\(\hat{\epsilon_t^2}\)</span>, (d) sample PACF of <span class="math inline">\(\hat{\epsilon_t^2}\)</span>, in the ARMA(1,1)-GARCH(1,1) model for daily returns of adjusted closing prices of the S&amp;P500 Index from January 4, 1995 to February 25, 2021.
</p>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
<div id="other-arch-type-models" class="section level2">
<h2><span class="header-section-number">4.8</span> Other ARCH-Type Models</h2>
<ul>
<li>There are many other types of ARCH models.</li>
<li>It is important to use the context and any background theory, when choosing between different models for changing variance.</li>
</ul>
<div id="the-integrated-garch-igarch-model" class="section level3">
<h3><span class="header-section-number">4.8.1</span> The Integrated GARCH (IGARCH) model</h3>
<!-- IGARCH. Integrated Generalized Autoregressive Conditional heteroskedasticity (IGARCH) is a restricted version of the GARCH model, where the persistent parameters sum up to one, and imports a unit root in the GARCH process. -->
<!--- In many financial time series empirical analyses, the volatility of asset returns are highly persistent, as the $\alpha+\beta$ values in the fitted GARCh(1,1) models are very close to one-->
<ul>
<li>The GARCH model becomes an IGARCH mode, if the AR polynomial of the GARCH representation in Equation  has a unit root.</li>
<li>Similar to ARIMA models, in IGARCH models the impact of past squared shocks <span class="math inline">\(\eta_{t−i} = Y_{t-i}^2 −\sigma_{t-i}^2\)</span> for <span class="math inline">\(i&gt;0\)</span> on <span class="math inline">\(Y_t^2\)</span> is persistent.</li>
<li>The IGARCH(1,1) model is of the form</li>
</ul>
<p><span class="math display">\[Y_t=\sigma_t\epsilon_t,\]</span>
<span class="math display">\[\sigma_t^2=\alpha+\beta\sigma_{t-1}^2+(1-\beta)Y_{t-1}^2,\]</span></p>
<p>where <span class="math inline">\(\{\epsilon_t\}\)</span> is a sequence of iid random variables with mean zero and variance 1 and <span class="math inline">\(0&lt;\beta&lt;1.\)</span></p>
<ul>
<li>More generally, model for <span class="math inline">\(Y_t\)</span> satisfying Equations  is said to follow a <strong>Integrated GARCH model</strong> of order <span class="math inline">\((m,s)\)</span> (<span class="math inline">\(IGARCH(m,s)\)</span>) when the local conditional variance is given by</li>
</ul>
<p><span class="math display">\[\begin{equation} \label{eq:5}
\sigma_t^2 =\alpha_0+\sum_{i=1}^m\alpha_iY_{t-i}^2+\sum_{j=1}^s\beta_j\sigma_{t-j}^2,
\end{equation}\]</span></p>
<p>where <span class="math inline">\(\{\epsilon_t\}\)</span> is a sequence of iid random variables with mean 0 and variance 1, with
<span class="math inline">\(\sum_{i=1}^{m}\alpha_i+\sum_{j=1}^{s}\beta_j=1.\)</span></p>
<!--Tsay page 141 - There is a major difference between the two models GARCH(1,1) and IGARCH(1,1).-->
<ul>
<li>Due to the above condition, the unconditional variance of <span class="math inline">\(Y_t\)</span>, hence that of <span class="math inline">\(X_t\)</span> , is not defined under <span class="math inline">\(IGARCH(1,1)\)</span> model.</li>
<li>Under certain conditions, the IGARCH models are strictly stationary but not weakly stationary as they do not have the first two moments.</li>
<li>When <span class="math inline">\(\alpha1 + \beta1 = 1\)</span>,
<span class="math display">\[\sigma^2_h(k )=\sigma^2_h(1 )+(k −1)\alpha_0,\quad k\geq1,\]</span>
where h is the forecast origin.</li>
</ul>
<!--tsay page 141-->
<ul>
<li>As a result, the effect of <span class="math inline">\(\sigma^2_h(1 )\)</span> on future volatilities is also persistent, and the volatility forecasts generates a straight line with slope <span class="math inline">\(\alpha_0\)</span>.</li>
<li>When <span class="math inline">\(\alpha_0 = 0\)</span>, the volatility forecasts are simply <span class="math inline">\(\sigma_h^2(1)\)</span> for all forecast horizons;
<!-- internet powerpoint

strict stationarity does not imply weak stationarity
Cauchy process which does not have moments.  A process could be drawn from an iid Cauchy distribution and therefore be strongly stationary but not weakly stationary.  
Constant data generating process that is constant over time with finite first and second moments, then strong stationarity will imply weak stationarity.  
Weak stationarity does not imply strong stationarity. 
most distributions are characterized by more parameters than the mean and variance and thus weak stationarity allows that other moments depend on t.  
The special case is a normal distribution which is fully characterized by its mean and variance and thus weak stationarity plus normality will imply strong stationarity.
--></li>
</ul>
<!--https://matzc.github.io/tmseries/lecture9.html#part3-->
<!-- two r packages, rugarch vs fgatch https://www.r-bloggers.com/2019/01/problems-in-estimating-garch-parameters-in-r-part-2-rugarch/-->
<div style="page-break-after: always;"></div>
<p><strong>Example in R</strong></p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb99-1" title="1"><span class="co"># For univariate GARCH models)</span></a>
<a class="sourceLine" id="cb99-2" title="2"><span class="kw">library</span>(rugarch) </a>
<a class="sourceLine" id="cb99-3" title="3">spec3 &lt;-<span class="st"> </span><span class="kw">ugarchspec</span>(</a>
<a class="sourceLine" id="cb99-4" title="4">  <span class="dt">variance.model=</span><span class="kw">list</span>(<span class="dt">model=</span><span class="st">&quot;iGARCH&quot;</span>,</a>
<a class="sourceLine" id="cb99-5" title="5">                      <span class="dt">garchOrder=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)),</a>
<a class="sourceLine" id="cb99-6" title="6">  <span class="dt">mean.model=</span><span class="kw">list</span>(<span class="dt">armaOrder=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),</a>
<a class="sourceLine" id="cb99-7" title="7">                  <span class="dt">include.mean=</span><span class="ot">FALSE</span>),</a>
<a class="sourceLine" id="cb99-8" title="8">  <span class="dt">distribution.model=</span><span class="st">&quot;norm&quot;</span>,</a>
<a class="sourceLine" id="cb99-9" title="9">  <span class="dt">fixed.pars=</span><span class="kw">list</span>(<span class="dt">omega=</span><span class="dv">0</span>))</a>
<a class="sourceLine" id="cb99-10" title="10">fit &lt;-<span class="st"> </span><span class="kw">ugarchfit</span>(spec3, </a>
<a class="sourceLine" id="cb99-11" title="11">       <span class="dt">data =</span> sp500_return<span class="op">$</span>daily.returns)</a>
<a class="sourceLine" id="cb99-12" title="12"><span class="kw">summary</span>(fit)</a>
<a class="sourceLine" id="cb99-13" title="13">fit</a>
<a class="sourceLine" id="cb99-14" title="14"><span class="kw">plot</span>(fit,<span class="dt">which=</span><span class="st">&quot;all&quot;</span>)</a></code></pre></div>
<ul>
<li>Useful materials: <a href="https://cran.r-project.org/web/packages/rugarch/vignettes/Introduction_to_the_rugarch_package.pdf">The <code>rugarch</code> package vignette</a></li>
</ul>
</div>
</div>
<div id="asymmetry-in-volatility" class="section level2">
<h2><span class="header-section-number">4.9</span> Asymmetry in Volatility</h2>
<!--https://asymmetryobservations.com/definitions/asymmetric-volatility/-->
<ul>
<li>Some equity markets show asymmetry in their volatility clusters</li>
<li>Asymmetric Volatility is when the volatility of a market or stock is higher when a market is in a downtrend and volatility tends to be lower in an uptrend.</li>
<li>There may be a range of causes of asymmetric volatility, but factors such as leverage, panic selling, and serial correlation are often some of the drivers.</li>
<li>The asymmetric GARCH models are employed to capture the asymmetric characteristics of volatility.</li>
</ul>
</div>
<div id="the-exponential-garch-model" class="section level2">
<h2><span class="header-section-number">4.10</span> The exponential GARCH model</h2>
<ul>
<li>In 1991, Nelson proposed the <strong>Exponential GARCH</strong> model to allow for asymmetric effects between positive and negative asset returns.</li>
<li>An <span class="math inline">\(EGARCH(h,k)\)</span> model can be written as</li>
</ul>
<p><span class="math display">\[Y_t=\sigma_t\epsilon_t,\]</span>
<span class="math display">\[\begin{equation} \label{eq:6}
log(\sigma_t^2) =\alpha_0+\sum_{i=1}^h\beta_ilog(\sigma_{t-i}^2)+ \sum_{j=1}^kf_j(\epsilon_{t-j})
\end{equation}\]</span></p>
<p>where the <span class="math inline">\(\{\epsilon_t\}\)</span> is a sequence of iid random variables with mean 0 and variance 1, and <span class="math inline">\(f_j(\epsilon)=\alpha_j\epsilon+\gamma_j(|\epsilon|-E|\epsilon|)\)</span></p>
<!--It can be seen that the random variable $f_j(\epsilon_t)$ is the sum of two 0 mean random variables $\alpha_j\epsilon_t$ and $\gamma_j(|\epsilon_t|-E|\epsilon_t|)$ -->
<ul>
<li>Both <span class="math inline">\(\epsilon_t\)</span> and <span class="math inline">\(|\epsilon_t|-E|\epsilon_t|\)</span> are zero-mean iid sequences with continuous distributions.</li>
<li>Therefore, <span class="math inline">\(E[f_j(\epsilon_t)]=0\)</span></li>
<li>The asymmetry of <span class="math inline">\(f_j(\epsilon_t)\)</span> can easily be seen by rewriting it as</li>
</ul>
<p><span class="math display">\[
    f_j(\epsilon_t)= 
\begin{cases}
    (\alpha_j+\gamma_j)\epsilon_t-\gamma_jE|\epsilon_t|,&amp; \text{if } \epsilon_t\geq 0\\
    (\alpha_j-\gamma_j)\epsilon_t-\gamma_jE|\epsilon_t|,&amp; \text{if } \epsilon_t&lt; 0
\end{cases}
\]</span></p>
<ul>
<li>This shows the asymmetry of the volatility response to positive and negative returns.</li>
<li>The model differs from the GARCH model in several ways
<ul>
<li>First, it uses logged conditional variance to relax the positiveness constraint of model coefficients.</li>
<li>Second, the use of <span class="math inline">\(f_j(\epsilon_t)\)</span> enables the model to respond asymmetrically to positive and negative lagged values of <span class="math inline">\(Y_t.\)</span></li>
</ul></li>
<li>Some additional properties of the EGARCH model can be found in Nelson (1991).</li>
</ul>
</div>
<div id="stochastic-volatility-models" class="section level2">
<h2><span class="header-section-number">4.11</span> Stochastic Volatility Models</h2>
<ul>
<li>The formulae for <span class="math inline">\(\sigma_t^2\)</span> in all GARCH type models are deterministic as there is no “error” term in either equation.</li>
<li>An alternative approach to ARCH or GARCH models is to assume that <span class="math inline">\(\sigma_t\)</span> follows a <strong>Stochastic process</strong>.</li>
<li>This can be usually done by modelling <span class="math inline">\(log(\sigma_t^2)\)</span> or <span class="math inline">\(log(\sigma_t)\)</span> to ensure that <span class="math inline">\(\sigma_t^2\)</span> remains positive.</li>
<li>Example: Let <span class="math inline">\(log(\sigma_t^2)=h_t\)</span> and <span class="math inline">\(h_t\)</span> follows an AR process with an “error” component that is independent of the <span class="math inline">\(\{\epsilon_t\}\)</span> in the innovation series <span class="math inline">\(\{Y_t\}\)</span>,</li>
</ul>
<p><span class="math display">\[Y_t=\sigma_t\epsilon_t, \quad \sigma_t^2=e^{h_t},\]</span></p>
<p><span class="math display">\[h_t=\phi_0+\phi_1h_{t-1}+\dots+\phi_ph_{t-p}+\eta_t,\]</span></p>
<p>which has <span class="math inline">\(AP(p)\)</span> dynamics for <span class="math inline">\(log\sigma_t^2.\)</span></p>
<ul>
<li>These type of models are called <strong>stochastic volatility</strong> or <strong>Stochastic variance models</strong>.</li>
<li>The <span class="math inline">\(\epsilon_t\)</span> and <span class="math inline">\(\eta_t\)</span> are assumed to be independent normally distributed random variables with <span class="math inline">\(\epsilon_t\sim N(0,1)\)</span> and <span class="math inline">\(\eta_t\sim N(0,\sigma^2)\)</span></li>
<li>In certain cases, it is more reasonable to assume that <span class="math inline">\(\sigma_t\)</span> changes stochastically through time rather than deterministically.
<ul>
<li>Example: During a sudden change in volatility in financial market due to a special event such as a war involving oil producing countries</li>
</ul></li>
</ul>
</div>
<div id="references-2" class="section level2">
<h2><span class="header-section-number">4.12</span> References:</h2>
<ul>
<li><p>Chatfield, C., &amp; Xing, H. (2019). The analysis of time series: an introduction with R. CRC press.</p></li>
<li><p>Tsay, R. S. (2010). Analysis of Financial Time Series. John Wiley &amp; Sons..
</p></li>
</ul>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-chatfield2019analysis">
<p>Chatfield, Chris, and Haipeng Xing. 2019. <em>The Analysis of Time Series: An Introduction with R</em>. CRC press.</p>
</div>
<div id="ref-tsay2010analysis">
<p>Tsay, Ruey S. 2010. <em>Analysis of Financial Time Series</em>. John Wiley &amp; Sons.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="exponential-smoothing.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="multivariate-time-series-modelling.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/04-VolatilityModels.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
