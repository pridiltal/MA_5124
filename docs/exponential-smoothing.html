<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Exponential Smoothing | MA 5124 Financial Time Series Analysis &amp; Forecasting</title>
  <meta name="description" content="Chapter 3 Exponential Smoothing | MA 5124 Financial Time Series Analysis &amp; Forecasting" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Exponential Smoothing | MA 5124 Financial Time Series Analysis &amp; Forecasting" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Exponential Smoothing | MA 5124 Financial Time Series Analysis &amp; Forecasting" />
  
  
  

<meta name="author" content="Dr. Priyanga D. Talagala" />


<meta name="date" content="2021-03-06" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="arima-models.html"/>
<link rel="next" href="volatility-models.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">MA 5124 Financial Time Series Analysis & Forecasting</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Course Syllabus</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#pre-requiites"><i class="fa fa-check"></i>Pre-requiites</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#learning-objectives"><i class="fa fa-check"></i>Learning Objectives</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#learning-outcomes"><i class="fa fa-check"></i>Learning Outcomes</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#outline-syllabus"><i class="fa fa-check"></i>Outline Syllabus</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#method-of-assessment"><i class="fa fa-check"></i>Method of Assessment</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#lecturer"><i class="fa fa-check"></i>Lecturer</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#schedule"><i class="fa fa-check"></i>Schedule</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#copyright-notice"><i class="fa fa-check"></i>Copyright Notice</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Intordution to Time Series Forecasting</a></li>
<li class="chapter" data-level="2" data-path="arima-models.html"><a href="arima-models.html"><i class="fa fa-check"></i><b>2</b> ARIMA models</a><ul>
<li class="chapter" data-level="2.1" data-path="arima-models.html"><a href="arima-models.html#stationarity-and-differencing"><i class="fa fa-check"></i><b>2.1</b> Stationarity and differencing</a><ul>
<li class="chapter" data-level="2.1.1" data-path="arima-models.html"><a href="arima-models.html#stationarity"><i class="fa fa-check"></i><b>2.1.1</b> Stationarity</a></li>
<li class="chapter" data-level="2.1.2" data-path="arima-models.html"><a href="arima-models.html#differencing"><i class="fa fa-check"></i><b>2.1.2</b> Differencing</a></li>
<li class="chapter" data-level="2.1.3" data-path="arima-models.html"><a href="arima-models.html#backshift-notation"><i class="fa fa-check"></i><b>2.1.3</b> Backshift notation</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="arima-models.html"><a href="arima-models.html#non-seasonal-arima-models"><i class="fa fa-check"></i><b>2.2</b> Non-seasonal ARIMA models</a><ul>
<li class="chapter" data-level="2.2.1" data-path="arima-models.html"><a href="arima-models.html#autoregressive-models"><i class="fa fa-check"></i><b>2.2.1</b> Autoregressive models</a></li>
<li class="chapter" data-level="2.2.2" data-path="arima-models.html"><a href="arima-models.html#moving-average-ma-models"><i class="fa fa-check"></i><b>2.2.2</b> Moving Average (MA) models</a></li>
<li class="chapter" data-level="2.2.3" data-path="arima-models.html"><a href="arima-models.html#invertibility"><i class="fa fa-check"></i><b>2.2.3</b> Invertibility</a></li>
<li class="chapter" data-level="2.2.4" data-path="arima-models.html"><a href="arima-models.html#arima-models-1"><i class="fa fa-check"></i><b>2.2.4</b> ARIMA models</a></li>
<li class="chapter" data-level="2.2.5" data-path="arima-models.html"><a href="arima-models.html#backshift-notation-for-arima"><i class="fa fa-check"></i><b>2.2.5</b> Backshift notation for ARIMA</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="arima-models.html"><a href="arima-models.html#estimation-and-order-selection"><i class="fa fa-check"></i><b>2.3</b> Estimation and order selection</a><ul>
<li class="chapter" data-level="2.3.1" data-path="arima-models.html"><a href="arima-models.html#maximum-likelihood-estimation"><i class="fa fa-check"></i><b>2.3.1</b> Maximum likelihood estimation</a></li>
<li class="chapter" data-level="2.3.2" data-path="arima-models.html"><a href="arima-models.html#partial-autocorrelations"><i class="fa fa-check"></i><b>2.3.2</b> Partial autocorrelations</a></li>
<li class="chapter" data-level="2.3.3" data-path="arima-models.html"><a href="arima-models.html#acf-and-pacf-interpretation"><i class="fa fa-check"></i><b>2.3.3</b> ACF and PACF interpretation</a></li>
<li class="chapter" data-level="2.3.4" data-path="arima-models.html"><a href="arima-models.html#information-criteria"><i class="fa fa-check"></i><b>2.3.4</b> Information criteria</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="arima-models.html"><a href="arima-models.html#seasonal-arima-models"><i class="fa fa-check"></i><b>2.4</b> Seasonal ARIMA models</a><ul>
<li class="chapter" data-level="2.4.1" data-path="arima-models.html"><a href="arima-models.html#common-arima-models"><i class="fa fa-check"></i><b>2.4.1</b> Common ARIMA models</a></li>
<li class="chapter" data-level="2.4.2" data-path="arima-models.html"><a href="arima-models.html#seasonal-arima-models-1"><i class="fa fa-check"></i><b>2.4.2</b> Seasonal ARIMA models</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="arima-models.html"><a href="arima-models.html#theoretical-properties-of-the-models"><i class="fa fa-check"></i><b>2.5</b> Theoretical properties of the models</a><ul>
<li class="chapter" data-level="2.5.1" data-path="arima-models.html"><a href="arima-models.html#autoregressive-ar-models"><i class="fa fa-check"></i><b>2.5.1</b> Autoregressive (AR) models</a></li>
<li class="chapter" data-level="2.5.2" data-path="arima-models.html"><a href="arima-models.html#moving-average-ma-models-1"><i class="fa fa-check"></i><b>2.5.2</b> Moving average (MA) models</a></li>
<li class="chapter" data-level="2.5.3" data-path="arima-models.html"><a href="arima-models.html#dual-relation-between-ar-and-ma-process"><i class="fa fa-check"></i><b>2.5.3</b> Dual relation between AR and MA process</a></li>
<li class="chapter" data-level="2.5.4" data-path="arima-models.html"><a href="arima-models.html#autoregressive-and-moving-average-arma-models"><i class="fa fa-check"></i><b>2.5.4</b> Autoregressive and Moving-average (ARMA) models</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="arima-models.html"><a href="arima-models.html#unit-root-tests"><i class="fa fa-check"></i><b>2.6</b> Unit root tests</a><ul>
<li class="chapter" data-level="2.6.1" data-path="arima-models.html"><a href="arima-models.html#dickey-fuller-test"><i class="fa fa-check"></i><b>2.6.1</b> Dickey-Fuller test</a></li>
<li class="chapter" data-level="2.6.2" data-path="arima-models.html"><a href="arima-models.html#augmented-dickey-fuller-test"><i class="fa fa-check"></i><b>2.6.2</b> Augmented Dickey-Fuller test</a></li>
<li class="chapter" data-level="2.6.3" data-path="arima-models.html"><a href="arima-models.html#stationarity-tests"><i class="fa fa-check"></i><b>2.6.3</b> Stationarity Tests</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="arima-models.html"><a href="arima-models.html#arima-modelling-in-r"><i class="fa fa-check"></i><b>2.7</b> ARIMA modelling in R</a><ul>
<li class="chapter" data-level="2.7.1" data-path="arima-models.html"><a href="arima-models.html#how-does-arima-work"><i class="fa fa-check"></i><b>2.7.1</b> How does ARIMA() work?</a></li>
<li class="chapter" data-level="2.7.2" data-path="arima-models.html"><a href="arima-models.html#choosing-your-own-model"><i class="fa fa-check"></i><b>2.7.2</b> Choosing your own model</a></li>
<li class="chapter" data-level="2.7.3" data-path="arima-models.html"><a href="arima-models.html#modelling-procedure-with-arima"><i class="fa fa-check"></i><b>2.7.3</b> Modelling procedure with <code>ARIMA()</code></a></li>
<li class="chapter" data-level="2.7.4" data-path="arima-models.html"><a href="arima-models.html#automatic-modelling-procedure-with-arima"><i class="fa fa-check"></i><b>2.7.4</b> Automatic modelling procedure with <code>ARIMA()</code></a></li>
<li class="chapter" data-level="2.7.5" data-path="arima-models.html"><a href="arima-models.html#example-in-r"><i class="fa fa-check"></i><b>2.7.5</b> Example in R</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="arima-models.html"><a href="arima-models.html#forecasting"><i class="fa fa-check"></i><b>2.8</b> Forecasting</a><ul>
<li class="chapter" data-level="2.8.1" data-path="arima-models.html"><a href="arima-models.html#point-forecasts"><i class="fa fa-check"></i><b>2.8.1</b> Point forecasts</a></li>
<li class="chapter" data-level="2.8.2" data-path="arima-models.html"><a href="arima-models.html#prediction-intervals"><i class="fa fa-check"></i><b>2.8.2</b> Prediction intervals</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="arima-models.html"><a href="arima-models.html#references"><i class="fa fa-check"></i><b>2.9</b> References:</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html"><i class="fa fa-check"></i><b>3</b> Exponential Smoothing</a><ul>
<li class="chapter" data-level="3.1" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#introduction"><i class="fa fa-check"></i><b>3.1</b> Introduction</a><ul>
<li class="chapter" data-level="3.1.1" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#historical-perspective"><i class="fa fa-check"></i><b>3.1.1</b> Historical perspective</a></li>
<li class="chapter" data-level="3.1.2" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#big-idea-control-the-rate-of-change"><i class="fa fa-check"></i><b>3.1.2</b> Big idea: control the rate of change</a></li>
<li class="chapter" data-level="3.1.3" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#a-model-for-levels-trends-and-seasonalities"><i class="fa fa-check"></i><b>3.1.3</b> A model for levels, trends, and seasonalities</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#simple-exponential-smoothing"><i class="fa fa-check"></i><b>3.2</b> Simple exponential smoothing</a><ul>
<li class="chapter" data-level="3.2.1" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#optimising-smoothing-parameters"><i class="fa fa-check"></i><b>3.2.1</b> Optimising smoothing parameters</a></li>
<li class="chapter" data-level="3.2.2" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#models-and-methods"><i class="fa fa-check"></i><b>3.2.2</b> Models and methods</a></li>
<li class="chapter" data-level="3.2.3" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#etsann-a-model-for-ses"><i class="fa fa-check"></i><b>3.2.3</b> ETS(A,N,N): A model for SES</a></li>
<li class="chapter" data-level="3.2.4" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#etsann"><i class="fa fa-check"></i><b>3.2.4</b> ETS(A,N,N)</a></li>
<li class="chapter" data-level="3.2.5" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#etsmnn"><i class="fa fa-check"></i><b>3.2.5</b> ETS(M,N,N)</a></li>
<li class="chapter" data-level="3.2.6" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#etsann-specifying-the-model"><i class="fa fa-check"></i><b>3.2.6</b> ETS(A,N,N): Specifying the model</a></li>
<li class="chapter" data-level="3.2.7" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#example-algerian-exports"><i class="fa fa-check"></i><b>3.2.7</b> Example: Algerian Exports</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#models-with-trend"><i class="fa fa-check"></i><b>3.3</b> Models with trend</a><ul>
<li class="chapter" data-level="3.3.1" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#holts-linear-trend"><i class="fa fa-check"></i><b>3.3.1</b> Holt’s linear trend</a></li>
<li class="chapter" data-level="3.3.2" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#etsaan"><i class="fa fa-check"></i><b>3.3.2</b> ETS(A,A,N)</a></li>
<li class="chapter" data-level="3.3.3" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#exponential-smoothing-trendslope"><i class="fa fa-check"></i><b>3.3.3</b> Exponential smoothing: trend/slope</a></li>
<li class="chapter" data-level="3.3.4" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#etsman"><i class="fa fa-check"></i><b>3.3.4</b> ETS(M,A,N)</a></li>
<li class="chapter" data-level="3.3.5" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#etsaan-specifying-the-model"><i class="fa fa-check"></i><b>3.3.5</b> ETS(A,A,N): Specifying the model</a></li>
<li class="chapter" data-level="3.3.6" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#example-australian-population"><i class="fa fa-check"></i><b>3.3.6</b> Example: Australian population</a></li>
<li class="chapter" data-level="3.3.7" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#damped-trend-method"><i class="fa fa-check"></i><b>3.3.7</b> Damped trend method</a></li>
<li class="chapter" data-level="3.3.8" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#example-australian-population-1"><i class="fa fa-check"></i><b>3.3.8</b> Example: Australian population</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#models-with-seasonality"><i class="fa fa-check"></i><b>3.4</b> Models with seasonality</a><ul>
<li class="chapter" data-level="3.4.1" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#holt-winters-additive-method"><i class="fa fa-check"></i><b>3.4.1</b> Holt-Winters additive method</a></li>
<li class="chapter" data-level="3.4.2" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#etsaaa"><i class="fa fa-check"></i><b>3.4.2</b> ETS(A,A,A)</a></li>
<li class="chapter" data-level="3.4.3" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#holt-winters-multiplicative-method"><i class="fa fa-check"></i><b>3.4.3</b> Holt-Winters multiplicative method</a></li>
<li class="chapter" data-level="3.4.4" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#etsmam"><i class="fa fa-check"></i><b>3.4.4</b> ETS(M,A,M)</a></li>
<li class="chapter" data-level="3.4.5" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#example-australian-holiday-tourism"><i class="fa fa-check"></i><b>3.4.5</b> Example: Australian holiday tourism</a></li>
<li class="chapter" data-level="3.4.6" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#holt-winters-damped-method"><i class="fa fa-check"></i><b>3.4.6</b> Holt-Winters damped method</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#innovations-state-space-models"><i class="fa fa-check"></i><b>3.5</b> Innovations state space models</a><ul>
<li class="chapter" data-level="3.5.1" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#exponential-smoothing-methods"><i class="fa fa-check"></i><b>3.5.1</b> Exponential smoothing methods</a></li>
<li class="chapter" data-level="3.5.2" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#ets-models"><i class="fa fa-check"></i><b>3.5.2</b> ETS models</a></li>
<li class="chapter" data-level="3.5.3" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#additive-error-models"><i class="fa fa-check"></i><b>3.5.3</b> Additive error models</a></li>
<li class="chapter" data-level="3.5.4" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#multiplicative-error-models"><i class="fa fa-check"></i><b>3.5.4</b> Multiplicative error models</a></li>
<li class="chapter" data-level="3.5.5" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#estimating-ets-models"><i class="fa fa-check"></i><b>3.5.5</b> Estimating ETS models</a></li>
<li class="chapter" data-level="3.5.6" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#innovations-state-space-models-1"><i class="fa fa-check"></i><b>3.5.6</b> Innovations state space models</a></li>
<li class="chapter" data-level="3.5.7" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#innovations-state-space-models-2"><i class="fa fa-check"></i><b>3.5.7</b> Innovations state space models</a></li>
<li class="chapter" data-level="3.5.8" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#parameter-restrictions"><i class="fa fa-check"></i><b>3.5.8</b> Parameter restrictions</a></li>
<li class="chapter" data-level="3.5.9" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#model-selection"><i class="fa fa-check"></i><b>3.5.9</b> Model selection</a></li>
<li class="chapter" data-level="3.5.10" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#aic-and-cross-validation"><i class="fa fa-check"></i><b>3.5.10</b> AIC and cross-validation</a></li>
<li class="chapter" data-level="3.5.11" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#automatic-forecasting"><i class="fa fa-check"></i><b>3.5.11</b> Automatic forecasting</a></li>
<li class="chapter" data-level="3.5.12" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#example-national-populations"><i class="fa fa-check"></i><b>3.5.12</b> Example: National populations</a></li>
<li class="chapter" data-level="3.5.13" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#example-australian-holiday-tourism-1"><i class="fa fa-check"></i><b>3.5.13</b> Example: Australian holiday tourism</a></li>
<li class="chapter" data-level="3.5.14" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#some-unstable-models"><i class="fa fa-check"></i><b>3.5.14</b> Some unstable models</a></li>
<li class="chapter" data-level="3.5.15" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#exponential-smoothing-models"><i class="fa fa-check"></i><b>3.5.15</b> Exponential smoothing models</a></li>
<li class="chapter" data-level="3.5.16" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#residuals"><i class="fa fa-check"></i><b>3.5.16</b> Residuals</a></li>
<li class="chapter" data-level="3.5.17" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#example-australian-holiday-tourism-2"><i class="fa fa-check"></i><b>3.5.17</b> Example: Australian holiday tourism</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#forecasting-with-exponential-smoothing"><i class="fa fa-check"></i><b>3.6</b> Forecasting with exponential smoothing</a><ul>
<li class="chapter" data-level="3.6.1" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#forecasting-with-ets-models"><i class="fa fa-check"></i><b>3.6.1</b> Forecasting with ETS models</a></li>
<li class="chapter" data-level="3.6.2" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#example-etsaan"><i class="fa fa-check"></i><b>3.6.2</b> Example: ETS(A,A,N)</a></li>
<li class="chapter" data-level="3.6.3" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#example-etsman"><i class="fa fa-check"></i><b>3.6.3</b> Example: ETS(M,A,N)</a></li>
<li class="chapter" data-level="3.6.4" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#forecasting-with-ets-models-1"><i class="fa fa-check"></i><b>3.6.4</b> Forecasting with ETS models</a></li>
<li class="chapter" data-level="3.6.5" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#prediction-intervals-1"><i class="fa fa-check"></i><b>3.6.5</b> Prediction intervals</a></li>
<li class="chapter" data-level="3.6.6" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#example-corticosteroid-drug-sales"><i class="fa fa-check"></i><b>3.6.6</b> Example: Corticosteroid drug sales</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#arima-vs-ets"><i class="fa fa-check"></i><b>3.7</b> ARIMA vs ETS</a><ul>
<li class="chapter" data-level="3.7.1" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#equivalences"><i class="fa fa-check"></i><b>3.7.1</b> Equivalences</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="exponential-smoothing.html"><a href="exponential-smoothing.html#references-1"><i class="fa fa-check"></i><b>3.8</b> References:</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="volatility-models.html"><a href="volatility-models.html"><i class="fa fa-check"></i><b>4</b> Volatility Models</a><ul>
<li class="chapter" data-level="4.1" data-path="volatility-models.html"><a href="volatility-models.html#introduction-1"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="volatility-models.html"><a href="volatility-models.html#structure-of-a-model-for-asset-returns"><i class="fa fa-check"></i><b>4.2</b> Structure of a Model for Asset Returns</a></li>
<li class="chapter" data-level="4.3" data-path="volatility-models.html"><a href="volatility-models.html#model-building"><i class="fa fa-check"></i><b>4.3</b> Model Building</a></li>
<li class="chapter" data-level="4.4" data-path="volatility-models.html"><a href="volatility-models.html#testing-for-arch-effect"><i class="fa fa-check"></i><b>4.4</b> Testing for ARCH Effect</a></li>
<li class="chapter" data-level="4.5" data-path="volatility-models.html"><a href="volatility-models.html#autoregressive-conditional-heteroskedastic-arch-models"><i class="fa fa-check"></i><b>4.5</b> Autoregressive Conditional Heteroskedastic (ARCH) Models</a><ul>
<li class="chapter" data-level="4.5.1" data-path="volatility-models.html"><a href="volatility-models.html#example-building-an-arch-model"><i class="fa fa-check"></i><b>4.5.1</b> Example: Building an ARCH Model</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="volatility-models.html"><a href="volatility-models.html#generalized-arch-garch-models"><i class="fa fa-check"></i><b>4.6</b> Generalized ARCH (GARCH) Models</a><ul>
<li class="chapter" data-level="4.6.1" data-path="volatility-models.html"><a href="volatility-models.html#prediction-of-volatilities"><i class="fa fa-check"></i><b>4.6.1</b> Prediction of volatilities</a></li>
<li class="chapter" data-level="4.6.2" data-path="volatility-models.html"><a href="volatility-models.html#example-building-a-garch-model"><i class="fa fa-check"></i><b>4.6.2</b> Example: Building a GARCH Model</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="volatility-models.html"><a href="volatility-models.html#the-arma-garch-models"><i class="fa fa-check"></i><b>4.7</b> The ARMA-GARCH Models</a><ul>
<li class="chapter" data-level="4.7.1" data-path="volatility-models.html"><a href="volatility-models.html#example-building-an-arma-garch-model"><i class="fa fa-check"></i><b>4.7.1</b> Example: Building an ARMA-GARCH Model</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="volatility-models.html"><a href="volatility-models.html#other-arch-type-models"><i class="fa fa-check"></i><b>4.8</b> Other ARCH-Type Models</a><ul>
<li class="chapter" data-level="4.8.1" data-path="volatility-models.html"><a href="volatility-models.html#the-integrated-garch-igarch-model"><i class="fa fa-check"></i><b>4.8.1</b> The Integrated GARCH (IGARCH) model</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="volatility-models.html"><a href="volatility-models.html#asymmetry-in-volatility"><i class="fa fa-check"></i><b>4.9</b> Asymmetry in Volatility</a></li>
<li class="chapter" data-level="4.10" data-path="volatility-models.html"><a href="volatility-models.html#the-exponential-garch-model"><i class="fa fa-check"></i><b>4.10</b> The exponential GARCH model</a></li>
<li class="chapter" data-level="4.11" data-path="volatility-models.html"><a href="volatility-models.html#stochastic-volatility-models"><i class="fa fa-check"></i><b>4.11</b> Stochastic Volatility Models</a></li>
<li class="chapter" data-level="4.12" data-path="volatility-models.html"><a href="volatility-models.html#references-2"><i class="fa fa-check"></i><b>4.12</b> References:</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="multivariate-time-series-modeliing.html"><a href="multivariate-time-series-modeliing.html"><i class="fa fa-check"></i><b>5</b> Multivariate Time Series Modeliing</a><ul>
<li class="chapter" data-level="5.1" data-path="multivariate-time-series-modeliing.html"><a href="multivariate-time-series-modeliing.html#references-3"><i class="fa fa-check"></i><b>5.1</b> References:</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references-4.html"><a href="references-4.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">MA 5124 Financial Time Series Analysis &amp; Forecasting</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="exponential-smoothing" class="section level1">
<h1><span class="header-section-number">Chapter 3</span> Exponential Smoothing</h1>

<div id="introduction" class="section level2">
<h2><span class="header-section-number">3.1</span> Introduction</h2>
<div id="historical-perspective" class="section level3">
<h3><span class="header-section-number">3.1.1</span> Historical perspective</h3>
<ul>
<li>Developed in the 1950s and 1960s as methods (algorithms) to produce point forecasts.</li>
<li>Combine a “level”, “trend” (slope) and “seasonal” component to describe a time series.</li>
<li>The rate of change of the components are controlled by “smoothing parameters”: <span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\beta\)</span> and <span class="math inline">\(\gamma\)</span> respectively.</li>
<li>Need to choose best values for the smoothing parameters (and initial states).</li>
<li>Equivalent ETS state space models developed in the 1990s and 2000s.</li>
</ul>
</div>
<div id="big-idea-control-the-rate-of-change" class="section level3">
<h3><span class="header-section-number">3.1.2</span> Big idea: control the rate of change</h3>
<p><span class="math inline">\(\alpha\)</span> controls the flexibility of the <strong>level</strong></p>
<ul>
<li>If <span class="math inline">\(\alpha = 0\)</span>, the level never updates (mean)</li>
<li>If <span class="math inline">\(\alpha = 1\)</span>, the level updates completely (naive)</li>
</ul>
<p><span class="math inline">\(\beta\)</span> controls the flexibility of the <strong>trend</strong></p>
<ul>
<li>If <span class="math inline">\(\beta = 0\)</span>, the trend is linear (regression trend)</li>
<li>If <span class="math inline">\(\beta = 1\)</span>, the trend updates every observation</li>
</ul>
<p><span class="math inline">\(\gamma\)</span> controls the flexibility of the <strong>seasonality</strong></p>
<ul>
<li>If <span class="math inline">\(\gamma = 0\)</span>, the seasonality is fixed (seasonal means)</li>
<li>If <span class="math inline">\(\gamma = 1\)</span>, the seasonality updates completely (seasonal naive)</li>
</ul>
</div>
<div id="a-model-for-levels-trends-and-seasonalities" class="section level3">
<h3><span class="header-section-number">3.1.3</span> A model for levels, trends, and seasonalities</h3>
<p>We want a model that captures the level (<span class="math inline">\(\ell_t\)</span>), trend (<span class="math inline">\(b_t\)</span>) and seasonality (<span class="math inline">\(s_t\)</span>).</p>
<p><strong>How do we combine these elements?</strong></p>
<ul>
<li>Additively?</li>
</ul>
<p><span class="math display">\[y_t = \ell_{t-1} + b_{t-1} + s_{t-m} + \varepsilon_t\]</span></p>
<ul>
<li>Multiplicatively?</li>
</ul>
<p><span class="math display">\[y_t = \ell_{t-1}b_{t-1}s_{t-m}(1 + \varepsilon_t)\]</span></p>
<ul>
<li>Perhaps a mix of both?</li>
</ul>
<p><span class="math display">\[y_t = (\ell_{t-1} + b_{t-1}) s_{t-m} + \varepsilon_t\]</span></p>
<p><strong>How do the level, trend and seasonal components evolve over time?</strong></p>
<p>General notation:</p>
<p><span class="math display">\[\text{ETS: } \textbf{E}\text{xponen}\textbf{T}\text{ial}\textbf{ S}\text{moothing}\]</span></p>
<p><strong>E</strong>rror: Additive (<code>"A"</code>) or multiplicative (<code>"M"</code>)</p>
<p><strong>T</strong>rend: None (<code>"N"</code>), additive (<code>"A"</code>), multiplicative (<code>"M"</code>), or damped (<code>"Ad"</code> or <code>"Md"</code>).</p>
<p><strong>S</strong>easonality: None (<code>"N"</code>), additive (<code>"A"</code>) or multiplicative (<code>"M"</code>)</p>
</div>
</div>
<div id="simple-exponential-smoothing" class="section level2">
<h2><span class="header-section-number">3.2</span> Simple exponential smoothing</h2>
<p>Time series <span class="math inline">\(y_1,y_2,\dots,y_T\)</span>.</p>
<p><strong>Random walk forecasts</strong>
<span class="math display">\[\hat{y}_{T+h|T} = y_T\]</span></p>
<p><strong>Average forecasts</strong></p>
<p><span class="math display">\[\hat{y}_{T+h|T} = \frac1T\sum_{t=1}^T y_t\]</span></p>
<ul>
<li>Want something in between these methods.</li>
<li>Most recent data should have more weight.</li>
</ul>
<!-- * Simple exponential smoothing uses a weighted moving average with weights that decrease exponentially. -->
<p><strong>Forecast equation</strong></p>
<p><span class="math display">\[\hat{y}_{T+1|T} = \alpha y_T + \alpha(1-\alpha) y_{T-1} + \alpha(1-\alpha)^2 y_{T-2}+ \cdots\]</span></p>
<p>where <span class="math inline">\(0 \le \alpha \le1\)</span></p>


<!-- animation-->
<p><strong>Component form</strong></p>
<ul>
<li><p>Forecast equation <span class="math inline">\(\hat{y}_{t+h|t} = \ell_{t}\)</span></p></li>
<li><p>Smoothing equation <span class="math inline">\(\ell_{t} = \alpha y_{t} + (1 - \alpha)\ell_{t-1}\)</span></p></li>
<li><span class="math inline">\(\ell_t\)</span> is the level (or the smoothed value) of the series at time t.</li>
<li><p><span class="math inline">\(\hat{y}_{t+1|t} = \alpha y_t + (1-\alpha) \hat{y}_{t|t-1}\)</span>
Iterate to get exponentially weighted moving average form.</p></li>
</ul>
<p><strong>Weighted average form</strong></p>
<p><span class="math display">\[\hat{y}_{T+1|T}=\sum_{j=0}^{T-1} \alpha(1-\alpha)^j y_{T-j}+(1-\alpha)^T \ell_{0}\]</span></p>
<div id="optimising-smoothing-parameters" class="section level3">
<h3><span class="header-section-number">3.2.1</span> Optimising smoothing parameters</h3>
<ul>
<li>Need to choose best values for <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\ell_0\)</span>.
<ul>
<li>Similarly to regression, choose optimal parameters by minimising SSE:</li>
</ul></li>
</ul>
<p><span class="math display">\[\text{SSE}=\sum_{t=1}^T(y_t-\hat{y}_{t|t-1})^2.\]</span></p>
<ul>
<li><p>Unlike regression there is no closed form solution — use numerical optimization.</p></li>
<li>For Algerian Exports example:
<ul>
<li><span class="math inline">\(\hat\alpha = 0.8400\)</span></li>
<li><span class="math inline">\(\hat\ell_0 = 39.54\)</span></li>
</ul>
<p><img src="bookdown-demo_files/figure-html/alpha-static-1.png" width="768" /></p></li>
</ul>
</div>
<div id="models-and-methods" class="section level3">
<h3><span class="header-section-number">3.2.2</span> Models and methods</h3>
<div id="methods" class="section level4">
<h4><span class="header-section-number">3.2.2.1</span> Methods</h4>
<ul>
<li>Algorithms that return point forecasts.</li>
</ul>
</div>
<div id="models" class="section level4">
<h4><span class="header-section-number">3.2.2.2</span> Models</h4>
<ul>
<li>Generate same point forecasts but can also generate forecast distributions.</li>
<li>A stochastic (or random) data generating process that can generate an entire forecast distribution.</li>
<li>Allow for “proper” model selection.</li>
</ul>
</div>
</div>
<div id="etsann-a-model-for-ses" class="section level3">
<h3><span class="header-section-number">3.2.3</span> ETS(A,N,N): A model for SES</h3>
<p><strong>Component form</strong></p>
<ul>
<li><p>Forecast equation: <span class="math inline">\(\hat{y}_{t+h|t} = \ell_{t}\)</span></p></li>
<li><p>Smoothing equation: <span class="math inline">\(\ell_{t} = \alpha y_{t} + (1 - \alpha)\ell_{t-1}\)</span></p></li>
</ul>
<p>Forecast error: <span class="math inline">\(e_t = y_t - \hat{y}_{t|t-1} = y_t - \ell_{t-1}\)</span></p>
<p><strong>Error correction form</strong></p>
<p><span class="math display">\[y_t = \ell_{t-1} + e_t\]</span>
<span class="math display">\[\ell_{t}= \ell_{t-1}+\alpha( y_{t}-\ell_{t-1})\]</span></p>
<p><span class="math inline">\(\ell_{t}=\ell_{t-1}+\alpha e_{t}\)</span></p>
<p>Specify probability distribution for <span class="math inline">\(e_t\)</span>, we assume <span class="math inline">\(e_t = \varepsilon_t\sim\text{NID}(0,\sigma^2)\)</span>.</p>
</div>
<div id="etsann" class="section level3">
<h3><span class="header-section-number">3.2.4</span> ETS(A,N,N)</h3>
<ul>
<li><p>Measurement equation: <span class="math inline">\(y_t = \ell_{t-1} + \varepsilon_t\)</span></p></li>
<li><p>State equation: <span class="math inline">\(\ell_t=\ell_{t-1}+\alpha \varepsilon_t\)</span></p></li>
</ul>
<p>where <span class="math inline">\(\varepsilon_t\sim\text{NID}(0,\sigma^2)\)</span>.</p>
<ul>
<li>“innovations” or “single source of error” because equations have the same error process, <span class="math inline">\(\varepsilon_t\)</span>.
<ul>
<li>Measurement equation: relationship between observations and states.</li>
<li>State equation(s): evolution of the state(s) through time.</li>
</ul></li>
</ul>
</div>
<div id="etsmnn" class="section level3">
<h3><span class="header-section-number">3.2.5</span> ETS(M,N,N)</h3>
<p>SES with multiplicative errors.</p>
<ul>
<li>Specify relative errors <span class="math inline">\(\varepsilon_t=\frac{y_t-\hat{y}_{t|t-1}}{\hat{y}_{t|t-1}}\sim \text{NID}(0,\sigma^2)\)</span>
<ul>
<li>Substituting <span class="math inline">\(\hat{y}_{t|t-1}=\ell_{t-1}\)</span> gives:
<ul>
<li><span class="math inline">\(y_t = \ell_{t-1}+\ell_{t-1}\varepsilon_t\)</span></li>
<li><span class="math inline">\(e_t = y_t - \hat{y}_{t|t-1} = \ell_{t-1}\varepsilon_t\)</span></li>
</ul></li>
</ul></li>
<li>Measurement equation: <span class="math inline">\(y_t = \ell_{t-1}(1 + \varepsilon_t)\)</span></li>
<li><p>State equation: <span class="math inline">\(\ell_t=\ell_{t-1}(1+\alpha \varepsilon_t)\)</span></p></li>
<li><p>Models with additive and multiplicative errors with the same parameters generate the same point forecasts but different prediction intervals.</p></li>
</ul>
</div>
<div id="etsann-specifying-the-model" class="section level3">
<h3><span class="header-section-number">3.2.6</span> ETS(A,N,N): Specifying the model</h3>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" title="1"><span class="kw">ETS</span>(y <span class="op">~</span><span class="st"> </span><span class="kw">error</span>(<span class="st">&quot;A&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">trend</span>(<span class="st">&quot;N&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">season</span>(<span class="st">&quot;N&quot;</span>))</a></code></pre></div>
<p>By default, an optimal value for <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\ell_0\)</span> is used.</p>
<p><span class="math inline">\(\alpha\)</span> can be chosen manually in <code>trend()</code>.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" title="1"><span class="kw">trend</span>(<span class="st">&quot;N&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb41-2" title="2"><span class="kw">trend</span>(<span class="st">&quot;N&quot;</span>, <span class="dt">alpha_range =</span> <span class="kw">c</span>(<span class="fl">0.2</span>, <span class="fl">0.8</span>))</a></code></pre></div>
</div>
<div id="example-algerian-exports" class="section level3">
<h3><span class="header-section-number">3.2.7</span> Example: Algerian Exports</h3>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" title="1">algeria_economy &lt;-<span class="st"> </span>global_economy <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb42-2" title="2"><span class="st">  </span><span class="kw">filter</span>(Country <span class="op">==</span><span class="st"> &quot;Algeria&quot;</span>)</a>
<a class="sourceLine" id="cb42-3" title="3">fit &lt;-<span class="st"> </span>algeria_economy <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb42-4" title="4"><span class="st">  </span><span class="kw">model</span>(<span class="dt">ANN =</span> <span class="kw">ETS</span>(Exports <span class="op">~</span><span class="st"> </span><span class="kw">error</span>(<span class="st">&quot;A&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">trend</span>(<span class="st">&quot;N&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">season</span>(<span class="st">&quot;N&quot;</span>)))</a>
<a class="sourceLine" id="cb42-5" title="5"><span class="kw">report</span>(fit)</a></code></pre></div>
<pre><code>## Series: Exports 
## Model: ETS(A,N,N) 
##   Smoothing parameters:
##     alpha = 0.84 
## 
##   Initial states:
##      l
##  39.54
## 
##   sigma^2:  35.63
## 
##   AIC  AICc   BIC 
## 446.7 447.2 452.9</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" title="1"><span class="kw">components</span>(fit) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">autoplot</span>()</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/ses-cmp0-1.png" width="672" /></p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" title="1"><span class="kw">components</span>(fit) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb45-2" title="2"><span class="st">  </span><span class="kw">left_join</span>(<span class="kw">fitted</span>(fit), <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;Country&quot;</span>, <span class="st">&quot;.model&quot;</span>, <span class="st">&quot;Year&quot;</span>))</a></code></pre></div>
<pre><code>## # A dable:                  59 x 7 [1Y]
## # Key:                      Country, .model [1]
## # ETS(A,N,N) Decomposition: Exports = lag(level, 1) +
## #   remainder
##    Country .model  Year Exports level remainder .fitted
##    &lt;fct&gt;   &lt;chr&gt;  &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
##  1 Algeria ANN     1959    NA    39.5    NA        NA  
##  2 Algeria ANN     1960    39.0  39.1    -0.496    39.5
##  3 Algeria ANN     1961    46.2  45.1     7.12     39.1
##  4 Algeria ANN     1962    19.8  23.8   -25.3      45.1
##  5 Algeria ANN     1963    24.7  24.6     0.841    23.8
##  6 Algeria ANN     1964    25.1  25.0     0.534    24.6
##  7 Algeria ANN     1965    22.6  23.0    -2.39     25.0
##  8 Algeria ANN     1966    26.0  25.5     3.00     23.0
##  9 Algeria ANN     1967    23.4  23.8    -2.07     25.5
## 10 Algeria ANN     1968    23.1  23.2    -0.630    23.8
## # … with 49 more rows</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" title="1">fit <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb47-2" title="2"><span class="st">  </span><span class="kw">forecast</span>(<span class="dt">h =</span> <span class="dv">5</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb47-3" title="3"><span class="st">  </span><span class="kw">autoplot</span>(algeria_economy) <span class="op">+</span></a>
<a class="sourceLine" id="cb47-4" title="4"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Exports (% of GDP)&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Year&quot;</span>)</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/ses-fc-1.png" width="672" /></p>
</div>
</div>
<div id="models-with-trend" class="section level2">
<h2><span class="header-section-number">3.3</span> Models with trend</h2>
<div id="holts-linear-trend" class="section level3">
<h3><span class="header-section-number">3.3.1</span> Holt’s linear trend</h3>
<p><strong>Component form</strong></p>
<ul>
<li>Forecast <span class="math inline">\(\hat{y}_{t+h|t} = \ell_{t} + hb_{t}\)</span></li>
<li>Level <span class="math inline">\(\ell_{t} = \alpha y_{t} + (1 - \alpha)(\ell_{t-1} + b_{t-1})\)</span></li>
<li><p>Trend <span class="math inline">\(b_{t} = \beta^*(\ell_{t} - \ell_{t-1}) + (1 -\beta^*)b_{t-1}\)</span></p></li>
<li>Two smoothing parameters <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta^*\)</span> (<span class="math inline">\(0\le\alpha,\beta^*\le1\)</span>).</li>
<li><span class="math inline">\(\ell_t\)</span> level: weighted average between <span class="math inline">\(y_t\)</span> and one-step ahead forecast for time <span class="math inline">\(t\)</span>, <span class="math inline">\((\ell_{t-1} + b_{t-1}=\hat{y}_{t|t-1})\)</span></li>
<li><span class="math inline">\(b_t\)</span> slope: weighted average of <span class="math inline">\((\ell_{t} - \ell_{t-1})\)</span> and <span class="math inline">\(b_{t-1}\)</span>, current and previous estimate of slope.</li>
<li><p>Choose <span class="math inline">\(\alpha, \beta^*, \ell_0, b_0\)</span> to minimise SSE.</p></li>
</ul>
</div>
<div id="etsaan" class="section level3">
<h3><span class="header-section-number">3.3.2</span> ETS(A,A,N)</h3>
<p>Holt’s linear method with additive errors.</p>
<ul>
<li>Assume <span class="math inline">\(\varepsilon_t=y_t-\ell_{t-1}-b_{t-1} \sim\text{NID}(0,\sigma^2)\)</span>.</li>
<li><p>Substituting into the error correction equations for Holt’s linear method</p>
<span class="math display">\[y_t=\ell_{t-1}+b_{t-1}+\varepsilon_t\]</span>
<span class="math display">\[\ell_t=\ell_{t-1}+b_{t-1}+\alpha \varepsilon_t\]</span>
<span class="math display">\[b_t=b_{t-1}+\alpha\beta^* \varepsilon_t\]</span></li>
<li><p>For simplicity, set <span class="math inline">\(\beta=\alpha \beta^*\)</span>.</p></li>
</ul>
</div>
<div id="exponential-smoothing-trendslope" class="section level3">
<h3><span class="header-section-number">3.3.3</span> Exponential smoothing: trend/slope</h3>
<p><img src="bookdown-demo_files/figure-html/beta-static1-1.png" width="768" /></p>
<p><img src="bookdown-demo_files/figure-html/beta-static2-1.png" width="768" /></p>
<p><img src="bookdown-demo_files/figure-html/beta-static3-1.png" width="768" /></p>
</div>
<div id="etsman" class="section level3">
<h3><span class="header-section-number">3.3.4</span> ETS(M,A,N)</h3>
<p>Holt’s linear method with multiplicative errors.</p>
<ul>
<li>Assume <span class="math inline">\(\varepsilon_t=\frac{y_t-(\ell_{t-1}+b_{t-1})}{(\ell_{t-1}+b_{t-1})}\)</span></li>
<li><p>Following a similar approach as above, the innovations state space model underlying Holt’s linear method with multiplicative errors is specified as</p>
<p><span class="math display">\[y_t=(\ell_{t-1}+b_{t-1})(1+\varepsilon_t)\]</span>
<span class="math display">\[\ell_t=(\ell_{t-1}+b_{t-1})(1+\alpha \varepsilon_t)\]</span>
<span class="math display">\[b_t=b_{t-1}+\beta(\ell_{t-1}+b_{t-1}) \varepsilon_t\]</span></p></li>
</ul>
<p>where again <span class="math inline">\(\beta=\alpha \beta^*\)</span> and <span class="math inline">\(\varepsilon_t \sim \text{NID}(0,\sigma^2)\)</span>.</p>
</div>
<div id="etsaan-specifying-the-model" class="section level3">
<h3><span class="header-section-number">3.3.5</span> ETS(A,A,N): Specifying the model</h3>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" title="1"><span class="kw">ETS</span>(y <span class="op">~</span><span class="st"> </span><span class="kw">error</span>(<span class="st">&quot;A&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">trend</span>(<span class="st">&quot;A&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">season</span>(<span class="st">&quot;N&quot;</span>))</a></code></pre></div>
<p>By default, optimal values for <span class="math inline">\(\beta\)</span> and <span class="math inline">\(b_0\)</span> are used.</p>
<p><span class="math inline">\(\beta\)</span> can be chosen manually in <code>trend()</code>.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" title="1"><span class="kw">trend</span>(<span class="st">&quot;A&quot;</span>, <span class="dt">beta =</span> <span class="fl">0.004</span>)</a>
<a class="sourceLine" id="cb49-2" title="2"><span class="kw">trend</span>(<span class="st">&quot;A&quot;</span>, <span class="dt">beta_range =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.1</span>))</a></code></pre></div>
</div>
<div id="example-australian-population" class="section level3">
<h3><span class="header-section-number">3.3.6</span> Example: Australian population</h3>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" title="1">aus_economy &lt;-<span class="st"> </span>global_economy <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(Code <span class="op">==</span><span class="st"> &quot;AUS&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb50-2" title="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Pop =</span> Population<span class="op">/</span><span class="fl">1e6</span>)</a>
<a class="sourceLine" id="cb50-3" title="3">fit &lt;-<span class="st"> </span>aus_economy <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb50-4" title="4"><span class="st">  </span><span class="kw">model</span>(<span class="dt">AAN =</span> <span class="kw">ETS</span>(Pop <span class="op">~</span><span class="st"> </span><span class="kw">error</span>(<span class="st">&quot;A&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">trend</span>(<span class="st">&quot;A&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">season</span>(<span class="st">&quot;N&quot;</span>)))</a>
<a class="sourceLine" id="cb50-5" title="5"><span class="kw">report</span>(fit)</a></code></pre></div>
<pre><code>## Series: Pop 
## Model: ETS(A,A,N) 
##   Smoothing parameters:
##     alpha = 0.9999 
##     beta  = 0.3266 
## 
##   Initial states:
##      l      b
##  10.05 0.2225
## 
##   sigma^2:  0.0041
## 
##    AIC   AICc    BIC 
## -76.99 -75.83 -66.68</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" title="1"><span class="kw">components</span>(fit) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">autoplot</span>()</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/holt-cmp-plot-1.png" width="672" /></p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" title="1"><span class="kw">components</span>(fit) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb53-2" title="2"><span class="st">  </span><span class="kw">left_join</span>(<span class="kw">fitted</span>(fit), <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;Country&quot;</span>, <span class="st">&quot;.model&quot;</span>, <span class="st">&quot;Year&quot;</span>))</a></code></pre></div>
<pre><code>## # A dable:                  59 x 8 [1Y]
## # Key:                      Country, .model [1]
## # ETS(A,A,N) Decomposition: Pop = lag(level, 1) +
## #   lag(slope, 1) + remainder
##    Country  .model  Year   Pop level slope remainder .fitted
##    &lt;fct&gt;    &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
##  1 Austral… AAN     1959  NA    10.1 0.222 NA           NA  
##  2 Austral… AAN     1960  10.3  10.3 0.222 -0.000145    10.3
##  3 Austral… AAN     1961  10.5  10.5 0.217 -0.0159      10.5
##  4 Austral… AAN     1962  10.7  10.7 0.231  0.0418      10.7
##  5 Austral… AAN     1963  11.0  11.0 0.223 -0.0229      11.0
##  6 Austral… AAN     1964  11.2  11.2 0.221 -0.00641     11.2
##  7 Austral… AAN     1965  11.4  11.4 0.221 -0.000314    11.4
##  8 Austral… AAN     1966  11.7  11.7 0.235  0.0418      11.6
##  9 Austral… AAN     1967  11.8  11.8 0.206 -0.0869      11.9
## 10 Austral… AAN     1968  12.0  12.0 0.208  0.00350     12.0
## # … with 49 more rows</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" title="1">fit <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb55-2" title="2"><span class="st">  </span><span class="kw">forecast</span>(<span class="dt">h =</span> <span class="dv">10</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb55-3" title="3"><span class="st">  </span><span class="kw">autoplot</span>(aus_economy) <span class="op">+</span></a>
<a class="sourceLine" id="cb55-4" title="4"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Population&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Year&quot;</span>)</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/holt-fc-1.png" width="672" /></p>
</div>
<div id="damped-trend-method" class="section level3">
<h3><span class="header-section-number">3.3.7</span> Damped trend method</h3>
<p><strong>Component form</strong></p>
<p><span class="math display">\[\hat{y}_{t+h|t} = \ell_{t} + (\phi+\phi^2 + \dots + \phi^{h})b_{t}\]</span>
<span class="math display">\[\ell_{t} = \alpha y_{t} + (1 - \alpha)(\ell_{t-1} + \phi b_{t-1})\]</span>
<span class="math display">\[b_{t} = \beta^*(\ell_{t} - \ell_{t-1}) + (1 -\beta^*)\phi b_{t-1}.\]</span></p>
<ul>
<li>Damping parameter <span class="math inline">\(0&lt;\phi&lt;1\)</span>.</li>
<li>If <span class="math inline">\(\phi=1\)</span>, identical to Holt’s linear trend.</li>
<li>As <span class="math inline">\(h\rightarrow\infty\)</span>, <span class="math inline">\(\hat{y}_{T+h|T}\rightarrow \ell_T+\phi b_T/(1-\phi)\)</span>.</li>
<li>Short-run forecasts trended, long-run forecasts constant.</li>
</ul>
</div>
<div id="example-australian-population-1" class="section level3">
<h3><span class="header-section-number">3.3.8</span> Example: Australian population</h3>
<ul>
<li>Write down the model for ETS(A,<span class="math inline">\(A_d\)</span>,N)</li>
</ul>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" title="1">aus_economy <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb56-2" title="2"><span class="st"> </span><span class="kw">model</span>(<span class="dt">holt =</span> <span class="kw">ETS</span>(Pop <span class="op">~</span><span class="st"> </span><span class="kw">error</span>(<span class="st">&quot;A&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">trend</span>(<span class="st">&quot;Ad&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">season</span>(<span class="st">&quot;N&quot;</span>))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb56-3" title="3"><span class="st"> </span><span class="kw">forecast</span>(<span class="dt">h =</span> <span class="dv">20</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb56-4" title="4"><span class="st"> </span><span class="kw">autoplot</span>(aus_economy)</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-31-1.png" width="672" /></p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" title="1">fit &lt;-<span class="st"> </span>aus_economy <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb57-2" title="2"><span class="st">  </span><span class="kw">filter</span>(Year <span class="op">&lt;=</span><span class="st"> </span><span class="dv">2010</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb57-3" title="3"><span class="st">  </span><span class="kw">model</span>(</a>
<a class="sourceLine" id="cb57-4" title="4">    <span class="dt">ses =</span> <span class="kw">ETS</span>(Pop <span class="op">~</span><span class="st"> </span><span class="kw">error</span>(<span class="st">&quot;A&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">trend</span>(<span class="st">&quot;N&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">season</span>(<span class="st">&quot;N&quot;</span>)),</a>
<a class="sourceLine" id="cb57-5" title="5">    <span class="dt">holt =</span> <span class="kw">ETS</span>(Pop <span class="op">~</span><span class="st"> </span><span class="kw">error</span>(<span class="st">&quot;A&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">trend</span>(<span class="st">&quot;A&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">season</span>(<span class="st">&quot;N&quot;</span>)),</a>
<a class="sourceLine" id="cb57-6" title="6">    <span class="dt">damped =</span> <span class="kw">ETS</span>(Pop <span class="op">~</span><span class="st"> </span><span class="kw">error</span>(<span class="st">&quot;A&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">trend</span>(<span class="st">&quot;Ad&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">season</span>(<span class="st">&quot;N&quot;</span>))</a>
<a class="sourceLine" id="cb57-7" title="7">  )</a></code></pre></div>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" title="1"><span class="kw">tidy</span>(fit)</a>
<a class="sourceLine" id="cb58-2" title="2"><span class="kw">accuracy</span>(fit)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">term</th>
<th align="right">SES</th>
<th align="right">Linear trend</th>
<th align="right">Damped trend</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">alpha</td>
<td align="right">1.00</td>
<td align="right">1.00</td>
<td align="right">1.00</td>
</tr>
<tr class="even">
<td align="right">beta^*</td>
<td align="right"></td>
<td align="right">0.30</td>
<td align="right">0.40</td>
</tr>
<tr class="odd">
<td align="right">phi</td>
<td align="right"></td>
<td align="right"></td>
<td align="right">0.98</td>
</tr>
<tr class="even">
<td align="right">l_0</td>
<td align="right">10.28</td>
<td align="right">10.05</td>
<td align="right">10.04</td>
</tr>
<tr class="odd">
<td align="right">b_0</td>
<td align="right"></td>
<td align="right">0.22</td>
<td align="right">0.25</td>
</tr>
<tr class="even">
<td align="right">Training RMSE</td>
<td align="right">0.24</td>
<td align="right">0.06</td>
<td align="right">0.07</td>
</tr>
<tr class="odd">
<td align="right">Test RMSE</td>
<td align="right">1.63</td>
<td align="right">0.15</td>
<td align="right">0.21</td>
</tr>
<tr class="even">
<td align="right">Test MASE</td>
<td align="right">6.18</td>
<td align="right">0.55</td>
<td align="right">0.75</td>
</tr>
<tr class="odd">
<td align="right">Test MAPE</td>
<td align="right">6.09</td>
<td align="right">0.55</td>
<td align="right">0.74</td>
</tr>
<tr class="even">
<td align="right">Test MAE</td>
<td align="right">1.45</td>
<td align="right">0.13</td>
<td align="right">0.18</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="models-with-seasonality" class="section level2">
<h2><span class="header-section-number">3.4</span> Models with seasonality</h2>
<div id="holt-winters-additive-method" class="section level3">
<h3><span class="header-section-number">3.4.1</span> Holt-Winters additive method</h3>
<p>Holt and Winters extended Holt’s method to capture seasonality.</p>
<p><strong>Component form</strong></p>
<p><span class="math display">\[\hat{y}_{t+h|t} = \ell_{t} + hb _{t} + s_{t+h-m(k+1)}\]</span>
<span class="math display">\[\ell_{t} = \alpha(y_{t} - s_{t-m}) + (1 - \alpha)(\ell_{t-1} + b_{t-1})\]</span>
<span class="math display">\[b_{t} = \beta^*(\ell_{t} - \ell_{t-1}) + (1 - \beta^*)b_{t-1}\]</span>
<span class="math display">\[s_{t} = \gamma (y_{t}-\ell_{t-1}-b_{t-1}) + (1-\gamma)s_{t-m}\]</span></p>
<ul>
<li><span class="math inline">\(k=\)</span> integer part of <span class="math inline">\((h-1)/m\)</span>. Ensures estimates from the final year are used for forecasting.
<ul>
<li>Parameters:  <span class="math inline">\(0\le \alpha\le 1\)</span>,  <span class="math inline">\(0\le \beta^*\le 1\)</span>,  <span class="math inline">\(0\le \gamma\le 1-\alpha\)</span>  and <span class="math inline">\(m=\)</span> period of seasonality (e.g. <span class="math inline">\(m=4\)</span> for quarterly data).</li>
</ul></li>
<li><p>Seasonal component is usually expressed as</p>
<span class="math display">\[s_{t} = \gamma^* (y_{t}-\ell_{t})+ (1-\gamma^*)s_{t-m}.\]</span></li>
<li><p>Substitute in for <span class="math inline">\(\ell_t\)</span>:</p>
<span class="math display">\[s_{t} = \gamma^*(1-\alpha) (y_{t}-\ell_{t-1}-b_{t-1})+ [1-\gamma^*(1-\alpha)]s_{t-m}\]</span></li>
<li>We set <span class="math inline">\(\gamma=\gamma^*(1-\alpha)\)</span>.</li>
<li><p>The usual parameter restriction is <span class="math inline">\(0\le\gamma^*\le1\)</span>, which translates to <span class="math inline">\(0\le\gamma\le(1-\alpha)\)</span>.</p></li>
</ul>
<p><img src="bookdown-demo_files/figure-html/gamma-static-1.png" width="768" /></p>
</div>
<div id="etsaaa" class="section level3">
<h3><span class="header-section-number">3.4.2</span> ETS(A,A,A)</h3>
<p>Holt-Winters additive method with additive errors.</p>
<ul>
<li>Forecast equation} <span class="math inline">\(\hat{y}_{t+h|t} = \ell_{t} + hb_{t} + s_{t+h-m(k+1)}\)</span></li>
<li>Observation equation} <span class="math inline">\(y_t=\ell_{t-1}+b_{t-1}+s_{t-m} + \varepsilon_t\)</span></li>
<li><p>State equations} <span class="math display">\[\ell_t=\ell_{t-1}+b_{t-1}+\alpha \varepsilon_t\]</span>
<span class="math display">\[b_t=b_{t-1}+\beta \varepsilon_t\]</span>
<span class="math display">\[s_t = s_{t-m} + \gamma\varepsilon_t\]</span></p></li>
<li>Forecast errors: <span class="math inline">\(\varepsilon_{t} = y_t - \hat{y}_{t|t-1}\)</span></li>
<li><p><span class="math inline">\(k\)</span> is integer part of <span class="math inline">\((h-1)/m\)</span></p></li>
</ul>
<p><strong>Activity</strong></p>
<ul>
<li>Write down the model for ETS(A,N,A)</li>
</ul>
</div>
<div id="holt-winters-multiplicative-method" class="section level3">
<h3><span class="header-section-number">3.4.3</span> Holt-Winters multiplicative method</h3>
<p>For when seasonal variations are changing proportional to the level of the series.</p>
<p><strong>Component form</strong></p>
<p><span class="math display">\[\hat{y}{t+h}{t} = (\ell_{t} + hb_{t})s_{t+h-m(k+1)}\]</span>
<span class="math display">\[\ell_{t} = \alpha \frac{y_{t}}{s_{t-m}} + (1 - \alpha)(\ell_{t-1} + b_{t-1})\]</span>
b_{t} &amp;= <span class="math display">\[\beta^*(\ell_{t}-\ell_{t-1}) + (1 - \beta^*)b_{t-1}\]</span>
<span class="math display">\[s_{t} = \gamma \frac{y_{t}}{(\ell_{t-1} + b_{t-1})} + (1 - \gamma)s_{t-m}\]</span></p>
<ul>
<li><span class="math inline">\(k\)</span> is integer part of <span class="math inline">\((h-1)/m\)</span>.</li>
<li>With additive method <span class="math inline">\(s_t\)</span> is in absolute terms:within each year <span class="math inline">\(\sum_i s_i \approx 0\)</span>.</li>
<li>With multiplicative method <span class="math inline">\(s_t\)</span> is in relative terms:within each year <span class="math inline">\(\sum_i s_i \approx m\)</span>.</li>
</ul>
</div>
<div id="etsmam" class="section level3">
<h3><span class="header-section-number">3.4.4</span> ETS(M,A,M)</h3>
<p>Holt-Winters multiplicative method with multiplicative errors.</p>
<ul>
<li>Forecast equation <span class="math inline">\(\hat{y}_{t+h|t} = (\ell_{t} + hb_{t}) s_{t+h-m(k+1)}\)</span></li>
<li>Observation equation <span class="math inline">\(y_t= (\ell_{t-1}+b_{t-1})s_{t-m}(1 + \varepsilon_t)\)</span></li>
<li><p>State equations <span class="math display">\[\ell_t=(\ell_{t-1}+b_{t-1})(1+\alpha \varepsilon_t)\]</span>
<span class="math display">\[b_t=b_{t-1} +\beta(\ell_{t-1}+b_{t-1}) \varepsilon_t\]</span>
<span class="math display">\[s_t = s_{t-m}(1 + \gamma\varepsilon_t)\]</span></p></li>
<li>Forecast errors: <span class="math inline">\(\varepsilon_{t} = (y_t - \hat{y}_{t|t-1})/\hat{y}_{t|t-1}\)</span></li>
<li><p><span class="math inline">\(k\)</span> is integer part of <span class="math inline">\((h-1)/m\)</span>.</p></li>
</ul>
</div>
<div id="example-australian-holiday-tourism" class="section level3">
<h3><span class="header-section-number">3.4.5</span> Example: Australian holiday tourism</h3>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" title="1">aus_holidays &lt;-<span class="st"> </span>tourism <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb59-2" title="2"><span class="st">  </span><span class="kw">filter</span>(Purpose <span class="op">==</span><span class="st"> &quot;Holiday&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb59-3" title="3"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">Trips =</span> <span class="kw">sum</span>(Trips))</a>
<a class="sourceLine" id="cb59-4" title="4">fit &lt;-<span class="st"> </span>aus_holidays <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb59-5" title="5"><span class="st">  </span><span class="kw">model</span>(</a>
<a class="sourceLine" id="cb59-6" title="6">    <span class="dt">additive =</span> <span class="kw">ETS</span>(Trips <span class="op">~</span><span class="st"> </span><span class="kw">error</span>(<span class="st">&quot;A&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">trend</span>(<span class="st">&quot;A&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">season</span>(<span class="st">&quot;A&quot;</span>)),</a>
<a class="sourceLine" id="cb59-7" title="7">    <span class="dt">multiplicative =</span> <span class="kw">ETS</span>(Trips <span class="op">~</span><span class="st"> </span><span class="kw">error</span>(<span class="st">&quot;M&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">trend</span>(<span class="st">&quot;A&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">season</span>(<span class="st">&quot;M&quot;</span>))</a>
<a class="sourceLine" id="cb59-8" title="8">  )</a>
<a class="sourceLine" id="cb59-9" title="9">fc &lt;-<span class="st"> </span>fit <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">forecast</span>()</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-35-1.png" width="672" /></p>
<p><strong>Estimated components</strong></p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" title="1"><span class="kw">components</span>(fit)</a></code></pre></div>
<pre><code>## # A dable:                               168 x 7 [1Q]
## # Key:                                   .model [2]
## # ETS(A,A,A) &amp; ETS(M,A,M) Decomposition: Trips = lag(level,
## #   1) + lag(slope, 1) + lag(season, 4) + remainder
##    .model   Quarter  Trips level slope season remainder
##    &lt;chr&gt;      &lt;qtr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;
##  1 additive 1997 Q1    NA    NA   NA    1512.      NA  
##  2 additive 1997 Q2    NA    NA   NA    -290.      NA  
##  3 additive 1997 Q3    NA    NA   NA    -684.      NA  
##  4 additive 1997 Q4    NA  9899. -37.4  -538.      NA  
##  5 additive 1998 Q1 11806. 9964. -24.5  1512.     433. 
##  6 additive 1998 Q2  9276. 9851. -35.6  -290.    -374. 
##  7 additive 1998 Q3  8642. 9700. -50.2  -684.    -489. 
##  8 additive 1998 Q4  9300. 9694. -44.6  -538.     188. 
##  9 additive 1999 Q1 11172. 9652. -44.3  1512.      10.7
## 10 additive 1999 Q2  9608. 9676. -35.6  -290.     290. 
## # … with 158 more rows</code></pre>
<p><img src="bookdown-demo_files/figure-html/fig-7-LevelTrendSeas-1.png" width="100%" /></p>
</div>
<div id="holt-winters-damped-method" class="section level3">
<h3><span class="header-section-number">3.4.6</span> Holt-Winters damped method</h3>
<p>Often the single most accurate forecasting method for seasonal data:</p>
<p><span class="math display">\[\hat{y}_{t+h|t} = [\ell_{t} + (\phi+\phi^2 + \dots + \phi^{h})b_{t}]s_{t+h-m(k+1)}\]</span>
<span class="math display">\[\ell_{t} = \alpha(y_{t} / s_{t-m}) + (1 - \alpha)(\ell_{t-1} + \phi b_{t-1})\]</span>
<span class="math display">\[b_{t} = \beta^*(\ell_{t} - \ell_{t-1}) + (1 - \beta^*)\phi b_{t-1}\]</span>
<span class="math display">\[s_{t} = \gamma \frac{y_{t}}{(\ell_{t-1} + \phi b_{t-1})} + (1 - \gamma)s_{t-m}\]</span></p>
<div style="page-break-after: always;"></div>
</div>
</div>
<div id="innovations-state-space-models" class="section level2">
<h2><span class="header-section-number">3.5</span> Innovations state space models</h2>
<div id="exponential-smoothing-methods" class="section level3">
<h3><span class="header-section-number">3.5.1</span> Exponential smoothing methods</h3>

<ul>
<li><span class="math inline">\((N,N)\)</span>: Simple exponential smoothing</li>
<li><span class="math inline">\((A,N)\)</span>: Holt’s linear method</li>
<li><span class="math inline">\((A_d,N)\)</span>: Additive damped trend method</li>
<li><span class="math inline">\((A,A)\)</span>: Additive Holt-Winters’ method</li>
<li><span class="math inline">\((A,M)\)</span>: Multiplicative Holt-Winters’ method</li>
<li><span class="math inline">\((A_d,M)\)</span>: Damped multiplicative Holt-Winters’ method</li>
</ul>
<p>There are also multiplicative trend methods (not recommended).</p>
</div>
<div id="ets-models" class="section level3">
<h3><span class="header-section-number">3.5.2</span> ETS models</h3>
<p><strong>Additive Error</strong></p>

<p><strong>Multiplicative Error</strong></p>

</div>
<div id="additive-error-models" class="section level3">
<h3><span class="header-section-number">3.5.3</span> Additive error models</h3>
<p><img src="fig/fig_7_ets_add.png" id="id1" class="class" style="width:100.0%;height:100.0%" /></p>
</div>
<div id="multiplicative-error-models" class="section level3">
<h3><span class="header-section-number">3.5.4</span> Multiplicative error models</h3>
<p><img src="fig/fig_7_ets_multi.png" id="id1" class="class" style="width:100.0%;height:100.0%" /></p>
</div>
<div id="estimating-ets-models" class="section level3">
<h3><span class="header-section-number">3.5.5</span> Estimating ETS models</h3>
<ul>
<li>Smoothing parameters <span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\beta\)</span>, <span class="math inline">\(\gamma\)</span> and <span class="math inline">\(\phi\)</span>, and the initial states <span class="math inline">\(\ell_0\)</span>, <span class="math inline">\(b_0\)</span>, <span class="math inline">\(s_0,s_{-1},\dots,s_{-m+1}\)</span> are estimated by maximising the “likelihood” = the probability of the data arising from the specified model.</li>
<li>For models with additive errors equivalent to minimising SSE.</li>
<li>For models with multiplicative errors, <strong>not</strong> equivalent to minimising SSE.</li>
</ul>
</div>
<div id="innovations-state-space-models-1" class="section level3">
<h3><span class="header-section-number">3.5.6</span> Innovations state space models</h3>
<p>Let <span class="math inline">\(\mathbf{x}_t = (\ell_t, b_t, s_t, s_{t-1}, \dots, s_{t-m+1})\)</span> and <span class="math inline">\(\varepsilon_t\stackrel{\mbox{\scriptsize iid}}{\sim} \mbox{N}(0,\sigma^2)\)</span>.</p>

<p><strong>Additive errors</strong></p>
<p><span class="math display">\[k(x)=1. \qquad y_t = \mu_{t} + \varepsilon_t.\]</span></p>
<p><strong>Multiplicative errors</strong></p>
<p><span class="math display">\[k(\mathbf{x}_{t-1}) = \mu_{t}.\qquad y_t = \mu_{t}(1 + \varepsilon_t).\]</span>
<span class="math display">\[\varepsilon_t = (y_t - \mu_t)/\mu_t \text{  is  relative error}.\]</span></p>
</div>
<div id="innovations-state-space-models-2" class="section level3">
<h3><span class="header-section-number">3.5.7</span> Innovations state space models</h3>
<p><strong>Estimation</strong></p>
<p><span class="math display">\[L^*(\mathbf\theta,\mathbf{x}_0) = T\log\!\bigg(\sum_{t=1}^T \varepsilon^2_t\!\bigg) + 2\sum_{t=1}^T \log|k(\mathbf{x}_{t-1})|\]</span>
<span class="math display">\[= -2\log(\text{Likelihood}) + \mbox{constant}\]</span></p>
<ul>
<li>Estimate parameters <span class="math inline">\(\mathbf\theta = (\alpha,\beta,\gamma,\phi)\)</span> and
initial states <span class="math inline">\(\mathbf{x}_0 = (\ell_0,b_0,s_0,s_{-1},\dots,s_{-m+1})\)</span> by
minimizing <span class="math inline">\(L^*\)</span>.</li>
</ul>
</div>
<div id="parameter-restrictions" class="section level3">
<h3><span class="header-section-number">3.5.8</span> Parameter restrictions</h3>
<div id="usual-region" class="section level4">
<h4><span class="header-section-number">3.5.8.1</span> <em>Usual</em> region</h4>
<ul>
<li>Traditional restrictions in the methods <span class="math inline">\(0&lt; \alpha,\beta^*,\gamma^*,\phi&lt;1\)</span>(equations interpreted as weighted averages).</li>
<li>In models we set <span class="math inline">\(\beta=\alpha\beta^*\)</span> and <span class="math inline">\(\gamma=(1-\alpha)\gamma^*\)</span>.</li>
<li>Therefore <span class="math inline">\(0&lt; \alpha &lt;1\)</span>,    <span class="math inline">\(0 &lt; \beta &lt; \alpha\)</span>    and <span class="math inline">\(0&lt; \gamma &lt; 1-\alpha\)</span>.</li>
<li><span class="math inline">\(0.8&lt;\phi&lt;0.98\)</span> — to prevent numerical difficulties.</li>
</ul>
</div>
<div id="admissible-region" class="section level4">
<h4><span class="header-section-number">3.5.8.2</span> <em>Admissible</em> region</h4>
<ul>
<li>To prevent observations in the distant past having a continuing effect on current forecasts.</li>
<li>Usually (but not always) less restrictive than the<em>traditional</em> region.</li>
<li>For example for ETS(A,N,N):  <span class="math inline">\(0&lt; \alpha &lt;1\)</span> —  is <span class="math inline">\(0&lt; \alpha &lt;2\)</span>.</li>
</ul>
</div>
</div>
<div id="model-selection" class="section level3">
<h3><span class="header-section-number">3.5.9</span> Model selection</h3>
<p><strong>Akaike’s Information Criterion</strong></p>
<p><span class="math display">\[\text{AIC} = -2\log(\text{L}) + 2k\]</span></p>
<p>where <span class="math inline">\(L\)</span> is the likelihood and <span class="math inline">\(k\)</span> is the number of parameters initial states estimated in the model.</p>
<p><strong>Corrected AIC</strong></p>
<p><span class="math display">\[\text{AIC}_{\text{c}} = \text{AIC} + \frac{2(k+1)(k+2)}{T-k}\]</span>
which is the AIC corrected (for small sample bias).</p>
<p><strong>Bayesian Information Criterion</strong></p>
<p><span class="math display">\[\text{BIC} = \text{AIC} + k(\log(T)-2).\]</span></p>
</div>
<div id="aic-and-cross-validation" class="section level3">
<h3><span class="header-section-number">3.5.10</span> AIC and cross-validation</h3>
<p>Minimizing the AIC assuming Gaussian residuals is asymptotically equivalent to minimizing one-step time series cross validation MSE.</p>
</div>
<div id="automatic-forecasting" class="section level3">
<h3><span class="header-section-number">3.5.11</span> Automatic forecasting</h3>
<p><strong>From Hyndman et al. (IJF, 2002):</strong></p>
<ul>
<li>Apply each model that is appropriate to the data.
Optimize parameters and initial values using MLE (or some other
criterion).</li>
<li>Select best method using AICc:</li>
<li>Produce forecasts using best method.</li>
<li>Obtain forecast intervals using underlying state space model.</li>
</ul>
<p>Method performed very well in M3 competition.</p>
</div>
<div id="example-national-populations" class="section level3">
<h3><span class="header-section-number">3.5.12</span> Example: National populations</h3>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" title="1">fit &lt;-<span class="st"> </span>global_economy <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb62-2" title="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Pop =</span> Population <span class="op">/</span><span class="st"> </span><span class="fl">1e6</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb62-3" title="3"><span class="st">  </span><span class="kw">model</span>(<span class="dt">ets =</span> <span class="kw">ETS</span>(Pop))</a>
<a class="sourceLine" id="cb62-4" title="4">fit</a></code></pre></div>
<pre><code>## # A mable: 263 x 2
## # Key:     Country [263]
##    Country                      ets
##    &lt;fct&gt;                    &lt;model&gt;
##  1 Afghanistan         &lt;ETS(A,A,N)&gt;
##  2 Albania             &lt;ETS(M,A,N)&gt;
##  3 Algeria             &lt;ETS(M,A,N)&gt;
##  4 American Samoa      &lt;ETS(M,A,N)&gt;
##  5 Andorra             &lt;ETS(M,A,N)&gt;
##  6 Angola              &lt;ETS(M,A,N)&gt;
##  7 Antigua and Barbuda &lt;ETS(M,A,N)&gt;
##  8 Arab World          &lt;ETS(M,A,N)&gt;
##  9 Argentina           &lt;ETS(A,A,N)&gt;
## 10 Armenia             &lt;ETS(M,A,N)&gt;
## # … with 253 more rows</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" title="1">fit <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb64-2" title="2"><span class="st">  </span><span class="kw">forecast</span>(<span class="dt">h =</span> <span class="dv">5</span>)</a></code></pre></div>
<pre><code>## # A fable: 1,315 x 5 [1Y]
## # Key:     Country, .model [263]
##    Country     .model  Year             Pop .mean
##    &lt;fct&gt;       &lt;chr&gt;  &lt;dbl&gt;          &lt;dist&gt; &lt;dbl&gt;
##  1 Afghanistan ets     2018    N(36, 0.012) 36.4 
##  2 Afghanistan ets     2019    N(37, 0.059) 37.3 
##  3 Afghanistan ets     2020     N(38, 0.16) 38.2 
##  4 Afghanistan ets     2021     N(39, 0.35) 39.0 
##  5 Afghanistan ets     2022     N(40, 0.64) 39.9 
##  6 Albania     ets     2018 N(2.9, 0.00012)  2.87
##  7 Albania     ets     2019   N(2.9, 6e-04)  2.87
##  8 Albania     ets     2020  N(2.9, 0.0017)  2.87
##  9 Albania     ets     2021  N(2.9, 0.0036)  2.86
## 10 Albania     ets     2022  N(2.9, 0.0066)  2.86
## # … with 1,305 more rows</code></pre>
</div>
<div id="example-australian-holiday-tourism-1" class="section level3">
<h3><span class="header-section-number">3.5.13</span> Example: Australian holiday tourism</h3>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" title="1">holidays &lt;-<span class="st"> </span>tourism <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb66-2" title="2"><span class="st">  </span><span class="kw">filter</span>(Purpose <span class="op">==</span><span class="st"> &quot;Holiday&quot;</span>)</a>
<a class="sourceLine" id="cb66-3" title="3">fit &lt;-<span class="st"> </span>holidays <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">model</span>(<span class="dt">ets =</span> <span class="kw">ETS</span>(Trips))</a>
<a class="sourceLine" id="cb66-4" title="4">fit</a></code></pre></div>
<pre><code>## # A mable: 76 x 4
## # Key:     Region, State, Purpose [76]
##    Region                State          Purpose          ets
##    &lt;chr&gt;                 &lt;chr&gt;          &lt;chr&gt;        &lt;model&gt;
##  1 Adelaide              South Austral… Holiday &lt;ETS(A,N,A)&gt;
##  2 Adelaide Hills        South Austral… Holiday &lt;ETS(A,A,N)&gt;
##  3 Alice Springs         Northern Terr… Holiday &lt;ETS(M,N,A)&gt;
##  4 Australia&#39;s Coral Co… Western Austr… Holiday &lt;ETS(M,N,A)&gt;
##  5 Australia&#39;s Golden O… Western Austr… Holiday &lt;ETS(M,N,M)&gt;
##  6 Australia&#39;s North We… Western Austr… Holiday &lt;ETS(A,N,A)&gt;
##  7 Australia&#39;s South We… Western Austr… Holiday &lt;ETS(M,N,M)&gt;
##  8 Ballarat              Victoria       Holiday &lt;ETS(M,N,A)&gt;
##  9 Barkly                Northern Terr… Holiday &lt;ETS(A,N,A)&gt;
## 10 Barossa               South Austral… Holiday &lt;ETS(A,N,N)&gt;
## # … with 66 more rows</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" title="1">fit <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb68-2" title="2"><span class="st">  </span><span class="kw">filter</span>(Region <span class="op">==</span><span class="st"> &quot;Snowy Mountains&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb68-3" title="3"><span class="st">  </span><span class="kw">report</span>()</a></code></pre></div>
<pre><code>## Series: Trips 
## Model: ETS(M,N,A) 
##   Smoothing parameters:
##     alpha = 0.1571 
##     gamma = 0.0001001 
## 
##   Initial states:
##      l     s1    s2     s3     s4
##  141.7 -60.96 130.9 -42.24 -27.66
## 
##   sigma^2:  0.0388
## 
##   AIC  AICc   BIC 
## 852.0 853.6 868.7</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" title="1">fit <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb70-2" title="2"><span class="st">  </span><span class="kw">filter</span>(Region <span class="op">==</span><span class="st"> &quot;Snowy Mountains&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb70-3" title="3"><span class="st">  </span><span class="kw">components</span>(fit)</a></code></pre></div>
<pre><code>## # A dable:                  84 x 9 [1Q]
## # Key:                      Region, State, Purpose, .model
## #   [1]
## # ETS(M,N,A) Decomposition: Trips = (lag(level, 1) +
## #   lag(season, 4)) * (1 + remainder)
##    Region State Purpose .model Quarter Trips level season
##    &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;    &lt;qtr&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
##  1 Snowy… New … Holiday ets    1997 Q1  NA     NA   -27.7
##  2 Snowy… New … Holiday ets    1997 Q2  NA     NA   -42.2
##  3 Snowy… New … Holiday ets    1997 Q3  NA     NA   131. 
##  4 Snowy… New … Holiday ets    1997 Q4  NA    142.  -61.0
##  5 Snowy… New … Holiday ets    1998 Q1 101.   140.  -27.7
##  6 Snowy… New … Holiday ets    1998 Q2 112.   142.  -42.2
##  7 Snowy… New … Holiday ets    1998 Q3 310.   148.  131. 
##  8 Snowy… New … Holiday ets    1998 Q4  89.8  148.  -61.0
##  9 Snowy… New … Holiday ets    1999 Q1 112.   147.  -27.7
## 10 Snowy… New … Holiday ets    1999 Q2 103.   147.  -42.2
## # … with 74 more rows, and 1 more variable: remainder &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" title="1">fit <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb72-2" title="2"><span class="st">  </span><span class="kw">filter</span>(Region <span class="op">==</span><span class="st"> &quot;Snowy Mountains&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb72-3" title="3"><span class="st">  </span><span class="kw">components</span>(fit) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb72-4" title="4"><span class="st">  </span><span class="kw">autoplot</span>()</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/ausholidays-components-plot-1.png" width="672" /></p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb73-1" title="1">fit <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">forecast</span>()</a></code></pre></div>
<pre><code>## # A fable: 608 x 7 [1Q]
## # Key:     Region, State, Purpose, .model [76]
##    Region   State   Purpose .model Quarter       Trips .mean
##    &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;    &lt;qtr&gt;      &lt;dist&gt; &lt;dbl&gt;
##  1 Adelaide South … Holiday ets    2018 Q1 N(210, 457) 210. 
##  2 Adelaide South … Holiday ets    2018 Q2 N(173, 473) 173. 
##  3 Adelaide South … Holiday ets    2018 Q3 N(169, 489) 169. 
##  4 Adelaide South … Holiday ets    2018 Q4 N(186, 505) 186. 
##  5 Adelaide South … Holiday ets    2019 Q1 N(210, 521) 210. 
##  6 Adelaide South … Holiday ets    2019 Q2 N(173, 537) 173. 
##  7 Adelaide South … Holiday ets    2019 Q3 N(169, 553) 169. 
##  8 Adelaide South … Holiday ets    2019 Q4 N(186, 569) 186. 
##  9 Adelaid… South … Holiday ets    2018 Q1   N(19, 36)  19.4
## 10 Adelaid… South … Holiday ets    2018 Q2   N(20, 36)  19.6
## # … with 598 more rows</code></pre>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb75-1" title="1">fit <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb75-2" title="2"><span class="st">  </span><span class="kw">forecast</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb75-3" title="3"><span class="st">  </span><span class="kw">filter</span>(Region <span class="op">==</span><span class="st"> &quot;Snowy Mountains&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb75-4" title="4"><span class="st">  </span><span class="kw">autoplot</span>(holidays) <span class="op">+</span></a>
<a class="sourceLine" id="cb75-5" title="5"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Year&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Overnight trips (thousands)&quot;</span>)</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/ausholidays-forecast-plot-1.png" width="672" /></p>
</div>
<div id="some-unstable-models" class="section level3">
<h3><span class="header-section-number">3.5.14</span> Some unstable models</h3>
<ul>
<li>Some of the combinations of (Error, Trend, Seasonal) can lead to numerical difficulties; see equations with division by a state.</li>
<li>These are: ETS(A,N,M), ETS(A,A,M), ETS(A,<span class="math inline">\(A_d\)</span>,M).</li>
<li>Models with multiplicative errors are useful for strictly positive data, but are not numerically stable with data containing zeros or negative values. In that case only the six fully additive models will be applied.</li>
</ul>
</div>
<div id="exponential-smoothing-models" class="section level3">
<h3><span class="header-section-number">3.5.15</span> Exponential smoothing models</h3>
<p><strong>Additive Error</strong></p>

<div style="page-break-after: always;"></div>
<p><strong>Multiplicative Error</strong></p>

</div>
<div id="residuals" class="section level3">
<h3><span class="header-section-number">3.5.16</span> Residuals</h3>
<p><strong>Response residuals</strong></p>
<p><span class="math display">\[\hat{e}_t = y_t - \hat{y}_{t|t-1}\]</span></p>
<p><strong>Innovation residuals</strong></p>
<p>Additive error model:
<span class="math display">\[\hat\varepsilon_t = y_t - \hat{y}_{t|t-1}\]</span></p>
<p>Multiplicative error model:
<span class="math display">\[\hat\varepsilon_t = \frac{y_t - \hat{y}_{t|t-1}}{\hat{y}_{t|t-1}}\]</span></p>
</div>
<div id="example-australian-holiday-tourism-2" class="section level3">
<h3><span class="header-section-number">3.5.17</span> Example: Australian holiday tourism</h3>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" title="1">aus_holidays &lt;-<span class="st"> </span>tourism <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb76-2" title="2"><span class="st">  </span><span class="kw">filter</span>(Purpose <span class="op">==</span><span class="st"> &quot;Holiday&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb76-3" title="3"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">Trips =</span> <span class="kw">sum</span>(Trips))</a>
<a class="sourceLine" id="cb76-4" title="4">fit &lt;-<span class="st"> </span>aus_holidays <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb76-5" title="5"><span class="st">  </span><span class="kw">model</span>(<span class="dt">ets =</span> <span class="kw">ETS</span>(Trips)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb76-6" title="6"><span class="st">  </span><span class="kw">report</span>()</a></code></pre></div>
<pre><code>## Series: Trips 
## Model: ETS(M,N,M) 
##   Smoothing parameters:
##     alpha = 0.3578 
##     gamma = 0.0009686 
## 
##   Initial states:
##     l    s1     s2     s3    s4
##  9667 0.943 0.9268 0.9684 1.162
## 
##   sigma^2:  0.0022
## 
##  AIC AICc  BIC 
## 1331 1333 1348</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" title="1"><span class="kw">residuals</span>(fit)</a>
<a class="sourceLine" id="cb78-2" title="2"><span class="kw">residuals</span>(fit, <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>)</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-39-1.png" width="672" /></p>
</div>
</div>
<div id="forecasting-with-exponential-smoothing" class="section level2">
<h2><span class="header-section-number">3.6</span> Forecasting with exponential smoothing</h2>
<div id="forecasting-with-ets-models" class="section level3">
<h3><span class="header-section-number">3.6.1</span> Forecasting with ETS models</h3>
<p><strong>Point forecasts:</strong> iterate the equations for <span class="math inline">\(t=T+1,T+2,\dots,T+h\)</span> and set all <span class="math inline">\(\varepsilon_t=0\)</span> for <span class="math inline">\(t&gt;T\)</span>.</p>
<ul>
<li>Not the same as <span class="math inline">\(\text{E}(y_{t+h} | \mathbf{x}_t)\)</span> unless trend and seasonality are both additive.</li>
<li>Point forecasts for ETS(A,<em>,</em>) are identical to ETS(M,<em>,</em>) if the parameters are the same.</li>
</ul>
</div>
<div id="example-etsaan" class="section level3">
<h3><span class="header-section-number">3.6.2</span> Example: ETS(A,A,N)</h3>
<p><span class="math display">\[y_{T+1} = \ell_T + b_T  + \varepsilon_{T+1}\]</span>
<span class="math display">\[\hat{y}_{T+1|T} = \ell_{T}+b_{T}\]</span>
<span class="math display">\[y_{T+2}       = \ell_{T+1} + b_{T+1} + \varepsilon_{T+2}\]</span>
<span class="math display">\[=
                      (\ell_T + b_T + \alpha\varepsilon_{T+1}) +
                      (b_T + \beta \varepsilon_{T+1}) +
        \varepsilon_{T+2}\]</span>
<span class="math display">\[\hat{y}_{T+2|T} = \ell_{T}+2b_{T}\]</span>
etc.</p>
</div>
<div id="example-etsman" class="section level3">
<h3><span class="header-section-number">3.6.3</span> Example: ETS(M,A,N)</h3>
<p><span class="math display">\[y_{T+1} = (\ell_T + b_T )(1+ \varepsilon_{T+1})\]</span>
<span class="math display">\[\hat{y}_{T+1|T} = \ell_{T}+b_{T}.\]</span>
<span class="math display">\[y_{T+2}         = (\ell_{T+1} + b_{T+1})(1 + \varepsilon_{T+2})\]</span>
<span class="math display">\[= \left\{
                    (\ell_T + b_T) (1+ \alpha\varepsilon_{T+1}) +
                    \left[b_T + \beta (\ell_T + b_T)\varepsilon_{T+1}\right]
                    \right\}
                   (1 + \varepsilon_{T+2})\]</span>
<span class="math display">\[\hat{y}_{T+2|T} = \ell_{T}+2b_{T}\]</span>
etc.</p>
</div>
<div id="forecasting-with-ets-models-1" class="section level3">
<h3><span class="header-section-number">3.6.4</span> Forecasting with ETS models</h3>
<p><strong>Prediction intervals:</strong> can only generated using the models.</p>
<ul>
<li>The prediction intervals will differ between models with additive and multiplicative errors.</li>
<li>Exact formulae for some models.</li>
<li>More general to simulate future sample paths, conditional on the last estimate of the states, and to obtain prediction intervals from the percentiles of these simulated future paths.</li>
</ul>
</div>
<div id="prediction-intervals-1" class="section level3">
<h3><span class="header-section-number">3.6.5</span> Prediction intervals</h3>
<p>PI for most ETS models: <span class="math inline">\(\hat{y}_{T+h|T} \pm c \sigma_h\)</span>, where <span class="math inline">\(c\)</span> depends on coverage probability and <span class="math inline">\(\sigma_h\)</span> is forecast standard deviation.</p>

<div style="page-break-after: always;"></div>
</div>
<div id="example-corticosteroid-drug-sales" class="section level3">
<h3><span class="header-section-number">3.6.6</span> Example: Corticosteroid drug sales</h3>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb79-1" title="1">h02 &lt;-<span class="st"> </span>PBS <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb79-2" title="2"><span class="st">  </span><span class="kw">filter</span>(ATC2 <span class="op">==</span><span class="st"> &quot;H02&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb79-3" title="3"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">Cost =</span> <span class="kw">sum</span>(Cost))</a>
<a class="sourceLine" id="cb79-4" title="4">h02 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb79-5" title="5"><span class="st">  </span><span class="kw">autoplot</span>(Cost)</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/h02-plot-1.png" width="672" /></p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" title="1">h02 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb80-2" title="2"><span class="st">  </span><span class="kw">model</span>(<span class="kw">ETS</span>(Cost)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb80-3" title="3"><span class="st">  </span><span class="kw">report</span>()</a></code></pre></div>
<pre><code>## Series: Cost 
## Model: ETS(M,Ad,M) 
##   Smoothing parameters:
##     alpha = 0.3071 
##     beta  = 0.0001007 
##     gamma = 0.0001007 
##     phi   = 0.9775 
## 
##   Initial states:
##       l    b     s1    s2     s3     s4     s5    s6    s7
##  417269 8206 0.8717 0.826 0.7563 0.7733 0.6872 1.284 1.325
##    s8    s9   s10   s11    s12
##  1.18 1.164 1.105 1.048 0.9806
## 
##   sigma^2:  0.0046
## 
##  AIC AICc  BIC 
## 5515 5519 5575</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" title="1">h02 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb82-2" title="2"><span class="st">  </span><span class="kw">model</span>(<span class="kw">ETS</span>(Cost <span class="op">~</span><span class="st"> </span><span class="kw">error</span>(<span class="st">&quot;A&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">trend</span>(<span class="st">&quot;A&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">season</span>(<span class="st">&quot;A&quot;</span>))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb82-3" title="3"><span class="st">  </span><span class="kw">report</span>()</a></code></pre></div>
<pre><code>## Series: Cost 
## Model: ETS(A,A,A) 
##   Smoothing parameters:
##     alpha = 0.1702 
##     beta  = 0.006311 
##     gamma = 0.4546 
## 
##   Initial states:
##       l    b     s1      s2      s3      s4      s5     s6
##  409706 9097 -99075 -136602 -191496 -174531 -241437 210644
##      s7     s8     s9   s10   s11    s12
##  244644 145368 130570 84458 39132 -11674
## 
##   sigma^2:  3.499e+09
## 
##  AIC AICc  BIC 
## 5585 5589 5642</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" title="1">h02 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">model</span>(<span class="kw">ETS</span>(Cost)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">forecast</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">autoplot</span>(h02)</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-42-1.png" width="672" /></p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb85-1" title="1">h02 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb85-2" title="2"><span class="st">  </span><span class="kw">model</span>(</a>
<a class="sourceLine" id="cb85-3" title="3">    <span class="dt">auto =</span> <span class="kw">ETS</span>(Cost),</a>
<a class="sourceLine" id="cb85-4" title="4">    <span class="dt">AAA =</span> <span class="kw">ETS</span>(Cost <span class="op">~</span><span class="st"> </span><span class="kw">error</span>(<span class="st">&quot;A&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">trend</span>(<span class="st">&quot;A&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">season</span>(<span class="st">&quot;A&quot;</span>))</a>
<a class="sourceLine" id="cb85-5" title="5">  ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb85-6" title="6"><span class="st">  </span><span class="kw">accuracy</span>()</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Model</th>
<th align="right">ME</th>
<th align="right">MAE</th>
<th align="right">RMSE</th>
<th align="right">MAPE</th>
<th align="right">MASE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">auto</td>
<td align="right">2461</td>
<td align="right">38649</td>
<td align="right">51102</td>
<td align="right">4.989</td>
<td align="right">0.6376</td>
</tr>
<tr class="even">
<td align="left">AAA</td>
<td align="right">-5780</td>
<td align="right">43378</td>
<td align="right">56784</td>
<td align="right">6.048</td>
<td align="right">0.7156</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="arima-vs-ets" class="section level2">
<h2><span class="header-section-number">3.7</span> ARIMA vs ETS</h2>
<ul>
<li><p>Myth that ARIMA models are more general than exponential smoothing.</p></li>
<li><p>Linear exponential smoothing models all special cases of ARIMA models.</p></li>
<li><p>Non-linear exponential smoothing models have no equivalent ARIMA counterparts.</p></li>
<li><p>Many ARIMA models have no exponential smoothing counterparts.</p></li>
<li><p>ETS models all non-stationary. Models with seasonality or non-damped trend (or both) have two unit roots; all other models have one unit </p></li>
</ul>
<p><img src="bookdown-demo_files/figure-html/venn-1.png" width="672" /></p>
<div style="page-break-after: always;"></div>
<div id="equivalences" class="section level3">
<h3><span class="header-section-number">3.7.1</span> Equivalences</h3>
<table>
<thead>
<tr class="header">
<th align="left"><strong>ETS model</strong></th>
<th align="left"><strong>ARIMA model</strong></th>
<th align="left"><strong>Parameters</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">ETS(A,N,N)</td>
<td align="left">ARIMA(0,1,1)</td>
<td align="left"><span class="math inline">\(\theta_1 = \alpha-1\)</span></td>
</tr>
<tr class="even">
<td align="left">ETS(A,A,N)</td>
<td align="left">ARIMA(0,2,2)</td>
<td align="left"><span class="math inline">\(\theta_1 = \alpha+\beta-2\)</span></td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><span class="math inline">\(\theta_2 = 1-\alpha\)</span></td>
</tr>
<tr class="even">
<td align="left">ETS(A,<span class="math inline">\(A_d\)</span>,N)</td>
<td align="left">ARIMA(1,1,2)</td>
<td align="left"><span class="math inline">\(\phi_1=\phi\)</span></td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="left"><span class="math inline">\(\theta_1 = \alpha+\phi\beta-1-\phi\)</span></td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="left"><span class="math inline">\(\theta_2 = (1-\alpha)\phi\)</span></td>
</tr>
<tr class="odd">
<td align="left">ETS(A,N,A)</td>
<td align="left">ARIMA(0,0,<span class="math inline">\(m\)</span>)(0,1,0)<span class="math inline">\(_m\)</span></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">ETS(A,A,A)</td>
<td align="left">ARIMA(0,1,<span class="math inline">\(m+1\)</span>)(0,1,0)<span class="math inline">\(_m\)</span></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">ETS(A,<span class="math inline">\(A_d\)</span>,A)</td>
<td align="left">ARIMA(1,0,<span class="math inline">\(m+1\)</span>)(0,1,0)<span class="math inline">\(_m\)</span></td>
<td align="left"></td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="references-1" class="section level2">
<h2><span class="header-section-number">3.8</span> References:</h2>
<ul>
<li>Hyndman, R. J., &amp; Athanasopoulos, G. (2018). Forecasting: principles and practice. OTexts.</li>
</ul>
<div style="page-break-after: always;"></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="arima-models.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="volatility-models.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/03-ExponentialSmoothing.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
